
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Kill Bill</title>

    <style media="screen">
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .ch, .highlight .cd, .highlight .cpf {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s, .highlight .sa, .highlight .dl {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf, .highlight .fm {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv, .highlight .vm {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .nl {
  color: #f92672;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <style media="print">
      * {
        -webkit-transition:none!important;
        transition:none!important;
      }
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight, .highlight .w {
  color: #586e75;
}
.highlight .err {
  color: #002b36;
  background-color: #dc322f;
}
.highlight .c, .highlight .ch, .highlight .cd, .highlight .cm, .highlight .cpf, .highlight .c1, .highlight .cs {
  color: #657b83;
}
.highlight .cp {
  color: #b58900;
}
.highlight .nt {
  color: #b58900;
}
.highlight .o, .highlight .ow {
  color: #93a1a1;
}
.highlight .p, .highlight .pi {
  color: #93a1a1;
}
.highlight .gi {
  color: #859900;
}
.highlight .gd {
  color: #dc322f;
}
.highlight .gh {
  color: #268bd2;
  background-color: #002b36;
  font-weight: bold;
}
.highlight .k, .highlight .kn, .highlight .kp, .highlight .kr, .highlight .kv {
  color: #6c71c4;
}
.highlight .kc {
  color: #cb4b16;
}
.highlight .kt {
  color: #cb4b16;
}
.highlight .kd {
  color: #cb4b16;
}
.highlight .s, .highlight .sb, .highlight .sc, .highlight .dl, .highlight .sd, .highlight .s2, .highlight .sh, .highlight .sx, .highlight .s1 {
  color: #859900;
}
.highlight .sa {
  color: #6c71c4;
}
.highlight .sr {
  color: #2aa198;
}
.highlight .si {
  color: #d33682;
}
.highlight .se {
  color: #d33682;
}
.highlight .nn {
  color: #b58900;
}
.highlight .nc {
  color: #b58900;
}
.highlight .no {
  color: #b58900;
}
.highlight .na {
  color: #268bd2;
}
.highlight .m, .highlight .mb, .highlight .mf, .highlight .mh, .highlight .mi, .highlight .il, .highlight .mo, .highlight .mx {
  color: #859900;
}
.highlight .ss {
  color: #859900;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>

  </head>

  <body class="usage" data-languages="[&quot;shell&quot;,&quot;java&quot;,&quot;ruby&quot;,&quot;python&quot;]">
    <div class="loader-wrapper">
      <div id="loading"></div>           
    </div>
    <script>
      $(window).on('load',function(){
        $('.loader-wrapper').hide();
      });
    </script>
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" alt="" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo.png" class="logo" alt="" />
        <div class="lang-selector">
              <a href="#" data-language-name="shell">shell</a>
              <a href="#" data-language-name="java">java</a>
              <a href="#" data-language-name="ruby">ruby</a>
              <a href="#" data-language-name="python">python</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <ul id="toc" class="toc-list-h1">
          <li>
            <a href="#usage" class="toc-h1 toc-link" data-title="Usage">Usage</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#usage-resource" class="toc-h2 toc-link" data-title="Usage Resource">Usage Resource</a>
                  </li>
                  <li>
                    <a href="#usage-2" class="toc-h2 toc-link" data-title="Usage">Usage</a>
                  </li>
              </ul>
          </li>
      </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='usage'>Usage</h1>
<p>When invoicing usage-based subscriptions, you need to record usage data into Kill Bill. Note that Kill Bill is not designed to be a metering system, so it shouldn&#39;t contain all data points. Instead, it expects that you record a usage summary on a daily basis (1 API call per subscription per day). For a telco company, for instance, instead of recording all phone calls, you should only record the number of minutes effectively used for each day.</p>

<p>For more information, see our <a href="http://docs.killbill.io/latest/userguide_subscription.html#components-catalog-usage">catalog usage documentation</a> and our <a href="http://docs.killbill.io/latest/userguide_subscription.html#components-invoicing-usage">invoice usage documentation</a>.</p>
<h2 id='usage-resource'>Usage Resource</h2>
<p>There are several resource objects associated with usage in Kill-Bill. These are shown below.</p>

<p><strong>SubscriptionUsageRecord</strong>, along with its components <strong>UnitUsageRecord</strong> and <strong>UsageRecord</strong>, is used to enter the daily usage summary into the system.</p>

<p><strong>SubscriptionUsageRecord</strong>:</p>

<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Generated by</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>subscriptionId</strong></td>
<td>string</td>
<td>system</td>
<td>UUID for the subscription</td>
</tr>
<tr>
<td><strong>trackingId</strong></td>
<td>string</td>
<td>user</td>
<td>User&#39;s tracking Id for this usage record</td>
</tr>
<tr>
<td><strong>unitUsageRecords</strong></td>
<td>list</td>
<td>user</td>
<td>List of <strong>UnitUsageRecord</strong> (see next)</td>
</tr>
</tbody></table>

<p><strong>UnitUsageRecord</strong>:</p>

<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Generated by</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>unitType</strong></td>
<td>string</td>
<td>user</td>
<td>Type of unit represented</td>
</tr>
<tr>
<td><strong>usageRecords</strong></td>
<td>list</td>
<td>user</td>
<td>List of <strong>UsageRecord</strong> for this unit (see next)</td>
</tr>
</tbody></table>

<p><strong>UsageRecord</strong>:</p>

<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Generated by</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>recordDate</strong></td>
<td>string</td>
<td>user</td>
<td>Date/DateTime for this record in <code>yyyy-mm-dd</code>/<code>yyyy-mm-ddThh:mm</code> format</td>
</tr>
<tr>
<td><strong>amount</strong></td>
<td>number</td>
<td>user</td>
<td>Amount of usage for this record</td>
</tr>
</tbody></table>

<p><strong>RolledUpUsage</strong>, along with its component <strong>RolledUpUnit</strong>, is used to maintain the cumulative record of usage over a specified period of time.</p>

<p><strong>RolledUpUsage</strong>:</p>

<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Generated by</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>subscriptionId</strong></td>
<td>string</td>
<td>system</td>
<td>UUID for the subscription</td>
</tr>
<tr>
<td><strong>startDate</strong></td>
<td>string</td>
<td>system</td>
<td>starting datetime for this record</td>
</tr>
<tr>
<td><strong>endDate</strong></td>
<td>string</td>
<td>system</td>
<td>ending datetime for this record</td>
</tr>
<tr>
<td><strong>rolledUpUnits</strong></td>
<td>list</td>
<td>system</td>
<td>List of <strong>RolledUpUnit</strong> (see next)</td>
</tr>
</tbody></table>

<p><strong>RolledUpUnit</strong>:</p>

<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Generated by</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>unitType</strong></td>
<td>string</td>
<td>system</td>
<td>type of unit represented</td>
</tr>
<tr>
<td><strong>amount</strong></td>
<td>number</td>
<td>system</td>
<td>total amount of usage of this unit</td>
</tr>
</tbody></table>
<h2 id='usage-2'>Usage</h2>
<p>The APIs in this group support recording and retrieving usage data points.</p>
<h3 id='record-usage-for-a-subscription'>Record usage for a subscription</h3>
<p>Records the daily mount of usage of a specified set of unit types for a given subscription</p>

<p><strong>HTTP Request</strong></p>

<p><code>POST http://127.0.0.1:8080/1.0/kb/usages</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code><span class="c"># With Date</span>

curl <span class="nt">-v</span> <span class="se">\</span>
    <span class="nt">-X</span> POST <span class="se">\</span>
    <span class="nt">-u</span> admin:password <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiKey: bob"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiSecret: lazar"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"Accept: application/json"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-CreatedBy: demo"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-Reason: demo"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-Comment: demo"</span> <span class="se">\</span>
     <span class="nt">-d</span> <span class="s1">'{"subscriptionId":"365987b2-5443-47e4-a467-c8962fc6995c", "trackingId": "my-unique-tracking-id", "unitUsageRecords":[{"unitType":"chocolate-videos","usageRecords":[{"recordDate":"2013-03-14","amount":1}]}]}'</span> <span class="se">\</span>
    <span class="s2">"http://localhost:8080/1.0/kb/usages"</span>

<span class="c"># With DateTime and amount as decimal</span>
curl <span class="nt">-v</span> <span class="se">\</span>
    <span class="nt">-X</span> POST <span class="se">\</span>
    <span class="nt">-u</span> admin:password <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiKey: bob"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiSecret: lazar"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"Accept: application/json"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-CreatedBy: demo"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-Reason: demo"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-Comment: demo"</span> <span class="se">\</span>
     <span class="nt">-d</span> <span class="s1">'{"subscriptionId":"f2d142c3-0157-4f86-a27a-3f0f64d71b2b", "trackingId": "t2", "unitUsageRecords":[{"unitType":"stones","usageRecords":[{"recordDate":"2023-02-07T10:00","amount":20.5}]}]}'</span> <span class="se">\</span>
    <span class="s2">"http://localhost:8080/1.0/kb/usages"</span>
</code></pre></div><div class="highlight"><pre class="highlight java tab-java"><code><span class="kn">import</span> <span class="nn">org.killbill.billing.client.api.gen.UsageApi</span><span class="o">;</span>
<span class="kd">protected</span> <span class="nc">UsageApi</span> <span class="n">usageApi</span><span class="o">;</span>

<span class="no">UUID</span> <span class="n">subscriptionId</span> <span class="o">=</span> <span class="no">UUID</span><span class="o">.</span><span class="na">fromString</span><span class="o">(</span><span class="s">"2daf08aa-3a32-45d7-9d75-9c667391f994"</span><span class="o">);</span>

<span class="nc">UsageRecord</span> <span class="n">usageRecord1</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">UsageRecord</span><span class="o">();</span>
<span class="n">usageRecord1</span><span class="o">.</span><span class="na">setAmount</span><span class="o">(</span><span class="nc">BigDecimal</span><span class="o">.</span><span class="na">ONE</span><span class="o">);</span>
<span class="n">usageRecord1</span><span class="o">.</span><span class="na">setRecordDate</span><span class="o">(</span><span class="k">new</span> <span class="nc">DateTime</span><span class="o">(</span><span class="s">"2023-02-27"</span><span class="o">));</span>

<span class="nc">UnitUsageRecord</span> <span class="n">unitUsageRecord</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">UnitUsageRecord</span><span class="o">();</span>
<span class="n">unitUsageRecord</span><span class="o">.</span><span class="na">setUnitType</span><span class="o">(</span><span class="s">"bullets"</span><span class="o">);</span>
<span class="n">unitUsageRecord</span><span class="o">.</span><span class="na">setUsageRecords</span><span class="o">(</span><span class="nc">List</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="n">usageRecord1</span><span class="o">));</span>

<span class="nc">SubscriptionUsageRecord</span> <span class="n">usage</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SubscriptionUsageRecord</span><span class="o">();</span>
<span class="n">usage</span><span class="o">.</span><span class="na">setSubscriptionId</span><span class="o">(</span><span class="n">subscriptionId</span><span class="o">);</span>
<span class="n">usage</span><span class="o">.</span><span class="na">setUnitUsageRecords</span><span class="o">(</span><span class="nc">List</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="n">unitUsageRecord</span><span class="o">));</span>

<span class="n">usageApi</span><span class="o">.</span><span class="na">recordUsage</span><span class="o">(</span><span class="n">usage</span><span class="o">,</span> <span class="n">requestOptions</span><span class="o">);</span>

</code></pre></div><div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="n">usage_record</span> <span class="o">=</span> <span class="no">KillBillClient</span><span class="o">::</span><span class="no">Model</span><span class="o">::</span><span class="no">UsageRecordAttributes</span><span class="p">.</span><span class="nf">new</span>
<span class="n">usage_record</span><span class="p">.</span><span class="nf">amount</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">usage_record</span><span class="p">.</span><span class="nf">record_date</span> <span class="o">=</span> <span class="s2">"2013-03-14"</span>

<span class="n">unit_usage_record</span> <span class="o">=</span> <span class="no">KillBillClient</span><span class="o">::</span><span class="no">Model</span><span class="o">::</span><span class="no">UnitUsageRecordAttributes</span><span class="p">.</span><span class="nf">new</span>
<span class="n">unit_usage_record</span><span class="p">.</span><span class="nf">unit_type</span> <span class="o">=</span> <span class="s2">"chocolate-videos"</span>
<span class="n">unit_usage_record</span><span class="p">.</span><span class="nf">usage_records</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">unit_usage_record</span><span class="p">.</span><span class="nf">usage_records</span> <span class="o">&lt;&lt;</span> <span class="n">usage_record</span>

<span class="n">result</span> <span class="o">=</span> <span class="no">KillBillClient</span><span class="o">::</span><span class="no">Model</span><span class="o">::</span><span class="no">UsageRecord</span><span class="p">.</span><span class="nf">new</span>
<span class="n">result</span><span class="p">.</span><span class="nf">subscription_id</span> <span class="o">=</span> <span class="s2">"365987b2-5443-47e4-a467-c8962fc6995c"</span>
<span class="n">result</span><span class="p">.</span><span class="nf">unit_usage_records</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">result</span><span class="p">.</span><span class="nf">unit_usage_records</span> <span class="o">&lt;&lt;</span> <span class="n">unit_usage_record</span>

<span class="n">result</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="kp">nil</span><span class="p">,</span> <span class="kp">nil</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="n">TODO</span>
</code></pre></div>
<p><strong>Request Body</strong></p>

<p>A SubscriptionUsageRecord.</p>

<p><strong>Query Parameters</strong></p>

<p>none</p>

<p><strong>Response</strong></p>

<p>If successful, returns a status code of 201 and an empty body.</p>
<h3 id='retrieve-usage-for-a-subscription-and-unit-type'>Retrieve usage for a subscription and unit type</h3>
<p>Retrieves the usage record for a given subscription, for a specified period of time and a specified unit type</p>

<p><strong>HTTP Request</strong></p>

<p><code>GET http://127.0.0.1:8080/1.0/kb/usages/{subscriptionId}/{unitType}</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="nt">-v</span> <span class="se">\</span>
    <span class="nt">-u</span> admin:password <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiKey: bob"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiSecret: lazar"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"Accept: application/json"</span> <span class="se">\</span>
    <span class="s2">"http://localhost:8080/1.0/kb/usages/365987b2-5443-47e4-a467-c8962fc6995c/chocolate-videos?startDate=2012-08-25&amp;endDate=2013-08-26"</span>
</code></pre></div><div class="highlight"><pre class="highlight java tab-java"><code><span class="kn">import</span> <span class="nn">org.killbill.billing.client.api.gen.UsageApi</span><span class="o">;</span>
<span class="kd">protected</span> <span class="nc">UsageApi</span> <span class="n">usageApi</span><span class="o">;</span>

<span class="no">UUID</span> <span class="n">subscriptionId</span> <span class="o">=</span> <span class="no">UUID</span><span class="o">.</span><span class="na">fromString</span><span class="o">(</span><span class="s">"365987b2-5443-47e4-a467-c8962fc6995c"</span><span class="o">);</span>

<span class="nc">String</span> <span class="n">unitType</span> <span class="o">=</span> <span class="s">"chocolate-videos"</span><span class="o">;</span>
<span class="nc">LocalDate</span> <span class="n">startDate</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">LocalDate</span><span class="o">(</span><span class="s">"2012-08-25"</span><span class="o">);</span>
<span class="nc">LocalDate</span> <span class="n">endDate</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">LocalDate</span><span class="o">(</span><span class="s">"2013-08-26"</span><span class="o">);</span>

<span class="nc">RolledUpUsage</span> <span class="n">retrievedUsage</span> <span class="o">=</span> <span class="n">usageApi</span><span class="o">.</span><span class="na">getUsage</span><span class="o">(</span><span class="n">subscriptionId</span><span class="o">,</span>
                                                 <span class="n">unitType</span><span class="o">,</span>
                                                 <span class="n">startDate</span><span class="o">,</span>
                                                 <span class="n">endDate</span><span class="o">,</span>
                                                 <span class="n">requestOptions</span><span class="o">);</span>
</code></pre></div><div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="n">subscription_id</span> <span class="o">=</span> <span class="s2">"365987b2-5443-47e4-a467-c8962fc6995c"</span>
<span class="n">start_date</span> <span class="o">=</span> <span class="s2">"2012-08-25"</span>
<span class="n">end_date_</span> <span class="o">=</span> <span class="s2">"2013-08-26"</span>
<span class="n">unit_type</span> <span class="o">=</span> <span class="s2">"chocolate-videos"</span>

<span class="no">KillBillClient</span><span class="o">::</span><span class="no">Model</span><span class="o">::</span><span class="no">RolledUpUsage</span><span class="p">.</span><span class="nf">find_by_subscription_id_and_type</span><span class="p">(</span><span class="n">subscription_id</span><span class="p">,</span>
                                                                      <span class="n">start_date</span><span class="p">,</span>
                                                                      <span class="n">end_date</span><span class="p">,</span>
                                                                      <span class="n">unit_type</span><span class="p">,</span>
                                                                      <span class="n">options</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="n">TODO</span>
</code></pre></div>
<blockquote>
<p>Example Response:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"subscriptionId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"365987b2-5443-47e4-a467-c8962fc6995c"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"startDate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2012-08-25"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"endDate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2013-08-26"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"rolledUpUnits"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"unitType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"chocolate-videos"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mf">10.5</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p><strong>Query Parameters</strong></p>

<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Required</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>startDate</strong></td>
<td>date</td>
<td>yes</td>
<td>none</td>
<td>Date/DateTime of oldest data point to retrieve (see below) in <code>yyyy-mm-dd</code>/<code>yyyy-mm-ddThh:mm</code> format</td>
</tr>
<tr>
<td><strong>endDate</strong></td>
<td>date</td>
<td>yes</td>
<td>none</td>
<td>Date/DateTime of newest data point to retrieve (see below) in <code>yyyy-mm-dd</code>/<code>yyyy-mm-ddThh:mm</code> format</td>
</tr>
</tbody></table>

<ul>
<li><strong>startDate</strong>, <strong>endDate</strong>: Data is retrieved beginning on the specified start date up to but not including the specified end date.</li>
</ul>

<p><strong>Response</strong></p>

<p>If successful, returns a status code of 200 and a RolledUpUsage object.</p>
<h3 id='retrieve-usage-for-a-subscription'>Retrieve usage for a subscription</h3>
<p>Retrieves the usage record for a given subscription, for a specified period of time and all unit types.</p>

<p><strong>HTTP Request</strong></p>

<p><code>GET http://127.0.0.1:8080/1.0/kb/usages/{subscriptionId}</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="nt">-v</span> <span class="se">\</span>
    <span class="nt">-u</span> admin:password <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiKey: bob"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiSecret: lazar"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"Accept: application/json"</span> <span class="se">\</span>
    <span class="s2">"http://localhost:8080/1.0/kb/usages/365987b2-5443-47e4-a467-c8962fc6995c?startDate=2012-08-25&amp;endDate=2013-08-26"</span>
</code></pre></div><div class="highlight"><pre class="highlight java tab-java"><code><span class="kn">import</span> <span class="nn">org.killbill.billing.client.api.gen.UsageApi</span><span class="o">;</span>
<span class="kd">protected</span> <span class="nc">UsageApi</span> <span class="n">usageApi</span><span class="o">;</span>

<span class="no">UUID</span> <span class="n">subscriptionId</span> <span class="o">=</span> <span class="no">UUID</span><span class="o">.</span><span class="na">fromString</span><span class="o">(</span><span class="s">"365987b2-5443-47e4-a467-c8962fc6995c"</span><span class="o">);</span>

<span class="nc">LocalDate</span> <span class="n">startDate</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">LocalDate</span><span class="o">(</span><span class="s">"2012-08-25"</span><span class="o">);</span>
<span class="nc">LocalDate</span> <span class="n">endDate</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">LocalDate</span><span class="o">(</span><span class="s">"2013-08-26"</span><span class="o">);</span>

<span class="nc">RolledUpUsage</span> <span class="n">retrievedUsage</span> <span class="o">=</span> <span class="n">usageApi</span><span class="o">.</span><span class="na">getAllUsage</span><span class="o">(</span><span class="n">subscriptionId</span><span class="o">,</span>
                                                    <span class="n">startDate</span><span class="o">,</span>
                                                    <span class="n">endDate</span><span class="o">,</span>
                                                    <span class="n">requestOptions</span><span class="o">);</span>
</code></pre></div><div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="n">subscription_id</span> <span class="o">=</span> <span class="s2">"365987b2-5443-47e4-a467-c8962fc6995c"</span>
<span class="n">start_date</span> <span class="o">=</span> <span class="s2">"2012-08-25"</span>
<span class="n">end_date</span> <span class="o">=</span> <span class="o">=</span> <span class="s2">"2013-08-26"</span>

<span class="no">KillBillClient</span><span class="o">::</span><span class="no">Model</span><span class="o">::</span><span class="no">RolledUpUsage</span><span class="p">.</span><span class="nf">find_by_subscription_id</span><span class="p">(</span><span class="n">subscription_id</span><span class="p">,</span>
                                                             <span class="n">start_date</span><span class="p">,</span>
                                                             <span class="n">end_date</span><span class="p">,</span>
                                                             <span class="n">options</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="n">TODO</span>
</code></pre></div>
<blockquote>
<p>Example Response:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"subscriptionId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"365987b2-5443-47e4-a467-c8962fc6995c"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"startDate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2012-08-25"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"endDate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2013-08-26"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"rolledUpUnits"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"unitType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"chocolate-videos"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p><strong>Query Parameters</strong></p>

<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Required</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>startDate</strong></td>
<td>date</td>
<td>yes</td>
<td>none</td>
<td>Date/DateTime of oldest data point to retrieve (see below) in <code>yyyy-mm-dd</code>/<code>yyyy-mm-ddThh:mm</code> format</td>
</tr>
<tr>
<td><strong>endDate</strong></td>
<td>date</td>
<td>yes</td>
<td>none</td>
<td>Date/DateTime of newest data point to retrieve (see below) in <code>yyyy-mm-dd</code>/<code>yyyy-mm-ddThh:mm</code> format</td>
</tr>
</tbody></table>

<ul>
<li><strong>startDate</strong>, <strong>endDate</strong>: Data is retrieved beginning on the specified start date/datetime up to but not including the specified end date/datetime.</li>
</ul>

<p><strong>Response</strong></p>

<p>IF successful, returns a status code of 200 and a RolledUpUsage object.</p>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="shell">shell</a>
                <a href="#" data-language-name="java">java</a>
                <a href="#" data-language-name="ruby">ruby</a>
                <a href="#" data-language-name="python">python</a>
          </div>

        <div id="docsearch"></div>
        
        <div id="toc" class="toc-list-h1">
            <li>
              <a href="#usage" class="toc-h1 toc-link" data-title="Usage">Usage</a>
                <ul class="toc-list-h2">
                    <li>
                      <a href="#usage-resource" class="toc-h2 toc-link" data-title="Usage Resource">Usage Resource</a>
                    </li>
                    <li>
                      <a href="#usage-2" class="toc-h2 toc-link" data-title="Usage">Usage</a>
                          <ul class="toc-list-h3">
                                <li>
                                  <a href="#record-usage-for-a-subscription" class="toc-h3 toc-link" data-title="Usage">Record usage for a subscription</a>
                                </li>
                                <li>
                                  <a href="#retrieve-usage-for-a-subscription-and-unit-type" class="toc-h3 toc-link" data-title="Usage">Retrieve usage for a subscription and unit type</a>
                                </li>
                                <li>
                                  <a href="#retrieve-usage-for-a-subscription" class="toc-h3 toc-link" data-title="Usage">Retrieve usage for a subscription</a>
                                </li>
                          </ul>
                    </li>
                </ul>
            </li>
        </div>
      </div>
      <div class="page-wrapper">
        <div class="dark-box"></div>
        <div class="content">
          <h1 id='usage'>Usage</h1>
<p>When invoicing usage-based subscriptions, you need to record usage data into Kill Bill. Note that Kill Bill is not designed to be a metering system, so it shouldn&#39;t contain all data points. Instead, it expects that you record a usage summary on a daily basis (1 API call per subscription per day). For a telco company, for instance, instead of recording all phone calls, you should only record the number of minutes effectively used for each day.</p>

<p>For more information, see our <a href="http://docs.killbill.io/latest/userguide_subscription.html#components-catalog-usage">catalog usage documentation</a> and our <a href="http://docs.killbill.io/latest/userguide_subscription.html#components-invoicing-usage">invoice usage documentation</a>.</p>
<h2 id='usage-resource'>Usage Resource</h2>
<p>There are several resource objects associated with usage in Kill-Bill. These are shown below.</p>

<p><strong>SubscriptionUsageRecord</strong>, along with its components <strong>UnitUsageRecord</strong> and <strong>UsageRecord</strong>, is used to enter the daily usage summary into the system.</p>

<p><strong>SubscriptionUsageRecord</strong>:</p>

<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Generated by</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>subscriptionId</strong></td>
<td>string</td>
<td>system</td>
<td>UUID for the subscription</td>
</tr>
<tr>
<td><strong>trackingId</strong></td>
<td>string</td>
<td>user</td>
<td>User&#39;s tracking Id for this usage record</td>
</tr>
<tr>
<td><strong>unitUsageRecords</strong></td>
<td>list</td>
<td>user</td>
<td>List of <strong>UnitUsageRecord</strong> (see next)</td>
</tr>
</tbody></table>

<p><strong>UnitUsageRecord</strong>:</p>

<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Generated by</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>unitType</strong></td>
<td>string</td>
<td>user</td>
<td>Type of unit represented</td>
</tr>
<tr>
<td><strong>usageRecords</strong></td>
<td>list</td>
<td>user</td>
<td>List of <strong>UsageRecord</strong> for this unit (see next)</td>
</tr>
</tbody></table>

<p><strong>UsageRecord</strong>:</p>

<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Generated by</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>recordDate</strong></td>
<td>string</td>
<td>user</td>
<td>Date/DateTime for this record in <code>yyyy-mm-dd</code>/<code>yyyy-mm-ddThh:mm</code> format</td>
</tr>
<tr>
<td><strong>amount</strong></td>
<td>number</td>
<td>user</td>
<td>Amount of usage for this record</td>
</tr>
</tbody></table>

<p><strong>RolledUpUsage</strong>, along with its component <strong>RolledUpUnit</strong>, is used to maintain the cumulative record of usage over a specified period of time.</p>

<p><strong>RolledUpUsage</strong>:</p>

<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Generated by</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>subscriptionId</strong></td>
<td>string</td>
<td>system</td>
<td>UUID for the subscription</td>
</tr>
<tr>
<td><strong>startDate</strong></td>
<td>string</td>
<td>system</td>
<td>starting datetime for this record</td>
</tr>
<tr>
<td><strong>endDate</strong></td>
<td>string</td>
<td>system</td>
<td>ending datetime for this record</td>
</tr>
<tr>
<td><strong>rolledUpUnits</strong></td>
<td>list</td>
<td>system</td>
<td>List of <strong>RolledUpUnit</strong> (see next)</td>
</tr>
</tbody></table>

<p><strong>RolledUpUnit</strong>:</p>

<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Generated by</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>unitType</strong></td>
<td>string</td>
<td>system</td>
<td>type of unit represented</td>
</tr>
<tr>
<td><strong>amount</strong></td>
<td>number</td>
<td>system</td>
<td>total amount of usage of this unit</td>
</tr>
</tbody></table>
<h2 id='usage-2'>Usage</h2>
<p>The APIs in this group support recording and retrieving usage data points.</p>
<h3 id='record-usage-for-a-subscription'>Record usage for a subscription</h3>
<p>Records the daily mount of usage of a specified set of unit types for a given subscription</p>

<p><strong>HTTP Request</strong></p>

<p><code>POST http://127.0.0.1:8080/1.0/kb/usages</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code><span class="c"># With Date</span>

curl <span class="nt">-v</span> <span class="se">\</span>
    <span class="nt">-X</span> POST <span class="se">\</span>
    <span class="nt">-u</span> admin:password <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiKey: bob"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiSecret: lazar"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"Accept: application/json"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-CreatedBy: demo"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-Reason: demo"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-Comment: demo"</span> <span class="se">\</span>
     <span class="nt">-d</span> <span class="s1">'{"subscriptionId":"365987b2-5443-47e4-a467-c8962fc6995c", "trackingId": "my-unique-tracking-id", "unitUsageRecords":[{"unitType":"chocolate-videos","usageRecords":[{"recordDate":"2013-03-14","amount":1}]}]}'</span> <span class="se">\</span>
    <span class="s2">"http://localhost:8080/1.0/kb/usages"</span>

<span class="c"># With DateTime and amount as decimal</span>
curl <span class="nt">-v</span> <span class="se">\</span>
    <span class="nt">-X</span> POST <span class="se">\</span>
    <span class="nt">-u</span> admin:password <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiKey: bob"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiSecret: lazar"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"Accept: application/json"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-CreatedBy: demo"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-Reason: demo"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-Comment: demo"</span> <span class="se">\</span>
     <span class="nt">-d</span> <span class="s1">'{"subscriptionId":"f2d142c3-0157-4f86-a27a-3f0f64d71b2b", "trackingId": "t2", "unitUsageRecords":[{"unitType":"stones","usageRecords":[{"recordDate":"2023-02-07T10:00","amount":20.5}]}]}'</span> <span class="se">\</span>
    <span class="s2">"http://localhost:8080/1.0/kb/usages"</span>
</code></pre></div><div class="highlight"><pre class="highlight java tab-java"><code><span class="kn">import</span> <span class="nn">org.killbill.billing.client.api.gen.UsageApi</span><span class="o">;</span>
<span class="kd">protected</span> <span class="nc">UsageApi</span> <span class="n">usageApi</span><span class="o">;</span>

<span class="no">UUID</span> <span class="n">subscriptionId</span> <span class="o">=</span> <span class="no">UUID</span><span class="o">.</span><span class="na">fromString</span><span class="o">(</span><span class="s">"2daf08aa-3a32-45d7-9d75-9c667391f994"</span><span class="o">);</span>

<span class="nc">UsageRecord</span> <span class="n">usageRecord1</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">UsageRecord</span><span class="o">();</span>
<span class="n">usageRecord1</span><span class="o">.</span><span class="na">setAmount</span><span class="o">(</span><span class="nc">BigDecimal</span><span class="o">.</span><span class="na">ONE</span><span class="o">);</span>
<span class="n">usageRecord1</span><span class="o">.</span><span class="na">setRecordDate</span><span class="o">(</span><span class="k">new</span> <span class="nc">DateTime</span><span class="o">(</span><span class="s">"2023-02-27"</span><span class="o">));</span>

<span class="nc">UnitUsageRecord</span> <span class="n">unitUsageRecord</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">UnitUsageRecord</span><span class="o">();</span>
<span class="n">unitUsageRecord</span><span class="o">.</span><span class="na">setUnitType</span><span class="o">(</span><span class="s">"bullets"</span><span class="o">);</span>
<span class="n">unitUsageRecord</span><span class="o">.</span><span class="na">setUsageRecords</span><span class="o">(</span><span class="nc">List</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="n">usageRecord1</span><span class="o">));</span>

<span class="nc">SubscriptionUsageRecord</span> <span class="n">usage</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SubscriptionUsageRecord</span><span class="o">();</span>
<span class="n">usage</span><span class="o">.</span><span class="na">setSubscriptionId</span><span class="o">(</span><span class="n">subscriptionId</span><span class="o">);</span>
<span class="n">usage</span><span class="o">.</span><span class="na">setUnitUsageRecords</span><span class="o">(</span><span class="nc">List</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="n">unitUsageRecord</span><span class="o">));</span>

<span class="n">usageApi</span><span class="o">.</span><span class="na">recordUsage</span><span class="o">(</span><span class="n">usage</span><span class="o">,</span> <span class="n">requestOptions</span><span class="o">);</span>

</code></pre></div><div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="n">usage_record</span> <span class="o">=</span> <span class="no">KillBillClient</span><span class="o">::</span><span class="no">Model</span><span class="o">::</span><span class="no">UsageRecordAttributes</span><span class="p">.</span><span class="nf">new</span>
<span class="n">usage_record</span><span class="p">.</span><span class="nf">amount</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">usage_record</span><span class="p">.</span><span class="nf">record_date</span> <span class="o">=</span> <span class="s2">"2013-03-14"</span>

<span class="n">unit_usage_record</span> <span class="o">=</span> <span class="no">KillBillClient</span><span class="o">::</span><span class="no">Model</span><span class="o">::</span><span class="no">UnitUsageRecordAttributes</span><span class="p">.</span><span class="nf">new</span>
<span class="n">unit_usage_record</span><span class="p">.</span><span class="nf">unit_type</span> <span class="o">=</span> <span class="s2">"chocolate-videos"</span>
<span class="n">unit_usage_record</span><span class="p">.</span><span class="nf">usage_records</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">unit_usage_record</span><span class="p">.</span><span class="nf">usage_records</span> <span class="o">&lt;&lt;</span> <span class="n">usage_record</span>

<span class="n">result</span> <span class="o">=</span> <span class="no">KillBillClient</span><span class="o">::</span><span class="no">Model</span><span class="o">::</span><span class="no">UsageRecord</span><span class="p">.</span><span class="nf">new</span>
<span class="n">result</span><span class="p">.</span><span class="nf">subscription_id</span> <span class="o">=</span> <span class="s2">"365987b2-5443-47e4-a467-c8962fc6995c"</span>
<span class="n">result</span><span class="p">.</span><span class="nf">unit_usage_records</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">result</span><span class="p">.</span><span class="nf">unit_usage_records</span> <span class="o">&lt;&lt;</span> <span class="n">unit_usage_record</span>

<span class="n">result</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="kp">nil</span><span class="p">,</span> <span class="kp">nil</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="n">TODO</span>
</code></pre></div>
<p><strong>Request Body</strong></p>

<p>A SubscriptionUsageRecord.</p>

<p><strong>Query Parameters</strong></p>

<p>none</p>

<p><strong>Response</strong></p>

<p>If successful, returns a status code of 201 and an empty body.</p>
<h3 id='retrieve-usage-for-a-subscription-and-unit-type'>Retrieve usage for a subscription and unit type</h3>
<p>Retrieves the usage record for a given subscription, for a specified period of time and a specified unit type</p>

<p><strong>HTTP Request</strong></p>

<p><code>GET http://127.0.0.1:8080/1.0/kb/usages/{subscriptionId}/{unitType}</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="nt">-v</span> <span class="se">\</span>
    <span class="nt">-u</span> admin:password <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiKey: bob"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiSecret: lazar"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"Accept: application/json"</span> <span class="se">\</span>
    <span class="s2">"http://localhost:8080/1.0/kb/usages/365987b2-5443-47e4-a467-c8962fc6995c/chocolate-videos?startDate=2012-08-25&amp;endDate=2013-08-26"</span>
</code></pre></div><div class="highlight"><pre class="highlight java tab-java"><code><span class="kn">import</span> <span class="nn">org.killbill.billing.client.api.gen.UsageApi</span><span class="o">;</span>
<span class="kd">protected</span> <span class="nc">UsageApi</span> <span class="n">usageApi</span><span class="o">;</span>

<span class="no">UUID</span> <span class="n">subscriptionId</span> <span class="o">=</span> <span class="no">UUID</span><span class="o">.</span><span class="na">fromString</span><span class="o">(</span><span class="s">"365987b2-5443-47e4-a467-c8962fc6995c"</span><span class="o">);</span>

<span class="nc">String</span> <span class="n">unitType</span> <span class="o">=</span> <span class="s">"chocolate-videos"</span><span class="o">;</span>
<span class="nc">LocalDate</span> <span class="n">startDate</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">LocalDate</span><span class="o">(</span><span class="s">"2012-08-25"</span><span class="o">);</span>
<span class="nc">LocalDate</span> <span class="n">endDate</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">LocalDate</span><span class="o">(</span><span class="s">"2013-08-26"</span><span class="o">);</span>

<span class="nc">RolledUpUsage</span> <span class="n">retrievedUsage</span> <span class="o">=</span> <span class="n">usageApi</span><span class="o">.</span><span class="na">getUsage</span><span class="o">(</span><span class="n">subscriptionId</span><span class="o">,</span>
                                                 <span class="n">unitType</span><span class="o">,</span>
                                                 <span class="n">startDate</span><span class="o">,</span>
                                                 <span class="n">endDate</span><span class="o">,</span>
                                                 <span class="n">requestOptions</span><span class="o">);</span>
</code></pre></div><div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="n">subscription_id</span> <span class="o">=</span> <span class="s2">"365987b2-5443-47e4-a467-c8962fc6995c"</span>
<span class="n">start_date</span> <span class="o">=</span> <span class="s2">"2012-08-25"</span>
<span class="n">end_date_</span> <span class="o">=</span> <span class="s2">"2013-08-26"</span>
<span class="n">unit_type</span> <span class="o">=</span> <span class="s2">"chocolate-videos"</span>

<span class="no">KillBillClient</span><span class="o">::</span><span class="no">Model</span><span class="o">::</span><span class="no">RolledUpUsage</span><span class="p">.</span><span class="nf">find_by_subscription_id_and_type</span><span class="p">(</span><span class="n">subscription_id</span><span class="p">,</span>
                                                                      <span class="n">start_date</span><span class="p">,</span>
                                                                      <span class="n">end_date</span><span class="p">,</span>
                                                                      <span class="n">unit_type</span><span class="p">,</span>
                                                                      <span class="n">options</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="n">TODO</span>
</code></pre></div>
<blockquote>
<p>Example Response:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"subscriptionId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"365987b2-5443-47e4-a467-c8962fc6995c"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"startDate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2012-08-25"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"endDate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2013-08-26"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"rolledUpUnits"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"unitType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"chocolate-videos"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mf">10.5</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p><strong>Query Parameters</strong></p>

<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Required</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>startDate</strong></td>
<td>date</td>
<td>yes</td>
<td>none</td>
<td>Date/DateTime of oldest data point to retrieve (see below) in <code>yyyy-mm-dd</code>/<code>yyyy-mm-ddThh:mm</code> format</td>
</tr>
<tr>
<td><strong>endDate</strong></td>
<td>date</td>
<td>yes</td>
<td>none</td>
<td>Date/DateTime of newest data point to retrieve (see below) in <code>yyyy-mm-dd</code>/<code>yyyy-mm-ddThh:mm</code> format</td>
</tr>
</tbody></table>

<ul>
<li><strong>startDate</strong>, <strong>endDate</strong>: Data is retrieved beginning on the specified start date up to but not including the specified end date.</li>
</ul>

<p><strong>Response</strong></p>

<p>If successful, returns a status code of 200 and a RolledUpUsage object.</p>
<h3 id='retrieve-usage-for-a-subscription'>Retrieve usage for a subscription</h3>
<p>Retrieves the usage record for a given subscription, for a specified period of time and all unit types.</p>

<p><strong>HTTP Request</strong></p>

<p><code>GET http://127.0.0.1:8080/1.0/kb/usages/{subscriptionId}</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="nt">-v</span> <span class="se">\</span>
    <span class="nt">-u</span> admin:password <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiKey: bob"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiSecret: lazar"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"Accept: application/json"</span> <span class="se">\</span>
    <span class="s2">"http://localhost:8080/1.0/kb/usages/365987b2-5443-47e4-a467-c8962fc6995c?startDate=2012-08-25&amp;endDate=2013-08-26"</span>
</code></pre></div><div class="highlight"><pre class="highlight java tab-java"><code><span class="kn">import</span> <span class="nn">org.killbill.billing.client.api.gen.UsageApi</span><span class="o">;</span>
<span class="kd">protected</span> <span class="nc">UsageApi</span> <span class="n">usageApi</span><span class="o">;</span>

<span class="no">UUID</span> <span class="n">subscriptionId</span> <span class="o">=</span> <span class="no">UUID</span><span class="o">.</span><span class="na">fromString</span><span class="o">(</span><span class="s">"365987b2-5443-47e4-a467-c8962fc6995c"</span><span class="o">);</span>

<span class="nc">LocalDate</span> <span class="n">startDate</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">LocalDate</span><span class="o">(</span><span class="s">"2012-08-25"</span><span class="o">);</span>
<span class="nc">LocalDate</span> <span class="n">endDate</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">LocalDate</span><span class="o">(</span><span class="s">"2013-08-26"</span><span class="o">);</span>

<span class="nc">RolledUpUsage</span> <span class="n">retrievedUsage</span> <span class="o">=</span> <span class="n">usageApi</span><span class="o">.</span><span class="na">getAllUsage</span><span class="o">(</span><span class="n">subscriptionId</span><span class="o">,</span>
                                                    <span class="n">startDate</span><span class="o">,</span>
                                                    <span class="n">endDate</span><span class="o">,</span>
                                                    <span class="n">requestOptions</span><span class="o">);</span>
</code></pre></div><div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="n">subscription_id</span> <span class="o">=</span> <span class="s2">"365987b2-5443-47e4-a467-c8962fc6995c"</span>
<span class="n">start_date</span> <span class="o">=</span> <span class="s2">"2012-08-25"</span>
<span class="n">end_date</span> <span class="o">=</span> <span class="o">=</span> <span class="s2">"2013-08-26"</span>

<span class="no">KillBillClient</span><span class="o">::</span><span class="no">Model</span><span class="o">::</span><span class="no">RolledUpUsage</span><span class="p">.</span><span class="nf">find_by_subscription_id</span><span class="p">(</span><span class="n">subscription_id</span><span class="p">,</span>
                                                             <span class="n">start_date</span><span class="p">,</span>
                                                             <span class="n">end_date</span><span class="p">,</span>
                                                             <span class="n">options</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="n">TODO</span>
</code></pre></div>
<blockquote>
<p>Example Response:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"subscriptionId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"365987b2-5443-47e4-a467-c8962fc6995c"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"startDate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2012-08-25"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"endDate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2013-08-26"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"rolledUpUnits"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"unitType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"chocolate-videos"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p><strong>Query Parameters</strong></p>

<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Required</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>startDate</strong></td>
<td>date</td>
<td>yes</td>
<td>none</td>
<td>Date/DateTime of oldest data point to retrieve (see below) in <code>yyyy-mm-dd</code>/<code>yyyy-mm-ddThh:mm</code> format</td>
</tr>
<tr>
<td><strong>endDate</strong></td>
<td>date</td>
<td>yes</td>
<td>none</td>
<td>Date/DateTime of newest data point to retrieve (see below) in <code>yyyy-mm-dd</code>/<code>yyyy-mm-ddThh:mm</code> format</td>
</tr>
</tbody></table>

<ul>
<li><strong>startDate</strong>, <strong>endDate</strong>: Data is retrieved beginning on the specified start date/datetime up to but not including the specified end date/datetime.</li>
</ul>

<p><strong>Response</strong></p>

<p>IF successful, returns a status code of 200 and a RolledUpUsage object.</p>

        </div>
        <div class="dark-box">
            <div class="lang-selector">
                  <a href="#" data-language-name="shell">shell</a>
                  <a href="#" data-language-name="java">java</a>
                  <a href="#" data-language-name="ruby">ruby</a>
                  <a href="#" data-language-name="python">python</a>
            </div>
        </div>
      </div>
    </div>
  </body>
  <script>
    setTimeout(function(){
      $('.content h2, .content h3, .content h4').append('<a href=""><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>');
      $('.content h2, .content h3, .content h4').each(function(){
        let itemHref = '#' + $(this).attr('id');
        $(this).find('a').attr("href", itemHref);
      });
    });
  </script>
  <script src='https://cdn.jsdelivr.net/npm/@docsearch/js@3'></script>	
  
  <script >docsearch({apiKey: '3ef227e7fd5e2e1a3fffd880484934bf', container: '#docsearch', appId: 'S2ISXITURI', indexName: 'killbill_slate'});</script>
</html>

