<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
      <title>Kill Bill</title>
      <style media="screen">
        .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .ch, .highlight .cd, .highlight .cpf {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s, .highlight .sa, .highlight .dl {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf, .highlight .fm {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv, .highlight .vm {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .nl {
  color: #f92672;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
      </style>
      <style media="print">
        * {
          -webkit-transition:none!important;
          transition:none!important;
        }
        .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight, .highlight .w {
  color: #586e75;
}
.highlight .err {
  color: #002b36;
  background-color: #dc322f;
}
.highlight .c, .highlight .ch, .highlight .cd, .highlight .cm, .highlight .cpf, .highlight .c1, .highlight .cs {
  color: #657b83;
}
.highlight .cp {
  color: #b58900;
}
.highlight .nt {
  color: #b58900;
}
.highlight .o, .highlight .ow {
  color: #93a1a1;
}
.highlight .p, .highlight .pi {
  color: #93a1a1;
}
.highlight .gi {
  color: #859900;
}
.highlight .gd {
  color: #dc322f;
}
.highlight .gh {
  color: #268bd2;
  background-color: #002b36;
  font-weight: bold;
}
.highlight .k, .highlight .kn, .highlight .kp, .highlight .kr, .highlight .kv {
  color: #6c71c4;
}
.highlight .kc {
  color: #cb4b16;
}
.highlight .kt {
  color: #cb4b16;
}
.highlight .kd {
  color: #cb4b16;
}
.highlight .s, .highlight .sb, .highlight .sc, .highlight .dl, .highlight .sd, .highlight .s2, .highlight .sh, .highlight .sx, .highlight .s1 {
  color: #859900;
}
.highlight .sa {
  color: #6c71c4;
}
.highlight .sr {
  color: #2aa198;
}
.highlight .si {
  color: #d33682;
}
.highlight .se {
  color: #d33682;
}
.highlight .nn {
  color: #b58900;
}
.highlight .nc {
  color: #b58900;
}
.highlight .no {
  color: #b58900;
}
.highlight .na {
  color: #268bd2;
}
.highlight .m, .highlight .mb, .highlight .mf, .highlight .mh, .highlight .mi, .highlight .il, .highlight .mo, .highlight .mx {
  color: #859900;
}
.highlight .ss {
  color: #859900;
}
      </style>
      <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
      <link href="stylesheets/print.css" rel="stylesheet" media="print" />
        <script src="javascripts/all.js"></script>
        <script>
          $(function() { setupCodeCopy(); });
        </script>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@3" />
    </head>
    <body class="invoice-payment" data-languages="[&quot;shell&quot;,&quot;java&quot;,&quot;ruby&quot;,&quot;python&quot;]">
      <header class="header sticky" id="header">
        <div class="header-wrapper">
          <div class="header-logo">
          <div class="logo-switch-wrapper">
              <div class="logo">
              <a href="/">
                <img src="images/logo/light-logo.svg" style="height:38px" alt="Kill Bill Docs" id="logo">
              </a>
            </div>
            <div class="switch">
              <input type="checkbox" id="theme-toggle">
              <span class="slider round"></span>
            </div>
          </div>
            <div class="header-search">
              <div class="search-form-wrapper">
                <div id="docsearch" style="height: 43px; display: flex; align-items: center; width: 100%;">
                </div>
              </div>
            </div>
          </div>
          <div class="nav-toggler sidebar-toggler">
            <svg class="hamburger" xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 24 24" fill="none">
              <path fill-rule="evenodd" clip-rule="evenodd" d="M20.75 7C20.75 7.41421 20.4142 7.75 20 7.75L4 7.75C3.58579 7.75 3.25 7.41421 3.25 7C3.25 6.58579 3.58579 6.25 4 6.25L20 6.25C20.4142 6.25 20.75 6.58579 20.75 7Z" fill=""/>
              <path fill-rule="evenodd" clip-rule="evenodd" d="M20.75 12C20.75 12.4142 20.4142 12.75 20 12.75L4 12.75C3.58579 12.75 3.25 12.4142 3.25 12C3.25 11.5858 3.58579 11.25 4 11.25L20 11.25C20.4142 11.25 20.75 11.5858 20.75 12Z" fill=""/>
              <path fill-rule="evenodd" clip-rule="evenodd" d="M20.75 17C20.75 17.4142 20.4142 17.75 20 17.75L4 17.75C3.58579 17.75 3.25 17.4142 3.25 17C3.25 16.5858 3.58579 16.25 4 16.25L20 16.25C20.4142 16.25 20.75 16.5858 20.75 17Z" fill=""/>
            </svg>
          </div>
            <div class="lang-selector">
                  <a href="#" data-language-name="shell">shell</a>
                  <a href="#" data-language-name="java">java</a>
                  <a href="#" data-language-name="ruby">ruby</a>
                  <a href="#" data-language-name="python">python</a>
            </div>
        </div>
      </header>
      <div class="loader-wrapper">
        <div id="loading"></div>
      </div>
      <script>
        $(window).on('load',function(){
          $('.loader-wrapper').hide();
        });
      </script>
      <a href="#" id="nav-button">
        <span>
          NAV
          <img src="images/navbar.png" alt="" />
        </span>
      </a>
      <div class="toc-wrapper">
          <div class="lang-selector">
                <a href="#" data-language-name="shell">shell</a>
                <a href="#" data-language-name="java">java</a>
                <a href="#" data-language-name="ruby">ruby</a>
                <a href="#" data-language-name="python">python</a>
          </div>
        <ul id="toc" class="toc-list-h1">
            <li>
                <a href="#invoice-payment" class="toc-h1 toc-link" data-title="Invoice Payment">Invoice Payment</a>
                <ul class="toc-list-h2">
                    <li>
                      <a href="#invoice-payment-resource" class="toc-h2 toc-link" data-title="Invoice Payment Resource">Invoice Payment Resource</a>
                    </li>
                    <li>
                      <a href="#invoice-payment-transaction-resource" class="toc-h2 toc-link" data-title="Invoice Payment Transaction Resource">Invoice Payment Transaction Resource</a>
                    </li>
                    <li>
                      <a href="#invoice-payment-2" class="toc-h2 toc-link" data-title="Invoice Payment">Invoice Payment</a>
                    </li>
                    <li>
                      <a href="#custom-fields" class="toc-h2 toc-link" data-title="Custom Fields">Custom Fields</a>
                    </li>
                    <li>
                      <a href="#tags" class="toc-h2 toc-link" data-title="Tags">Tags</a>
                    </li>
                    <li>
                      <a href="#audit-logs" class="toc-h2 toc-link" data-title="Audit Logs">Audit Logs</a>
                    </li>
                </ul>
            </li>
        </ul>
          <ul class="toc-footer">
              <li><a href="mailto:support@killbill.io">Report a doc problem </a></li>
          </ul>
      </div>
      <div class="page-wrapper">
        <div class="content">
          <h1 id='invoice-payment'>Invoice Payment</h1>
<p>An <code>InvoicePayment</code> is a <code>Payment</code> that is made against a specific invoice.</p>

<p>By default the system will always attempt to make a full payment against an invoice, but Kill Bill also allows multiple partial payments.  Partial payments can be made against unpaid - or partially paid - invoices by triggerring a payment against the <code>Invoice</code> resource. The reverse is not true; a single payment across multiple invoices is not (yet) supported.</p>

<p>See <a href="payment.html">Payment</a> for further information.</p>
<h2 id='invoice-payment-resource'>Invoice Payment Resource</h2>
<p>The <code>InvoicePayment</code> resource represents a payment associated with a given invoice. It is identical to the <code>Payment</code> resource except for the inclusion of the <strong>targetInvoiceId</strong> attribute. </p>

<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Generated by</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>targetInvoiceId</strong></td>
<td>string</td>
<td>system</td>
<td>UUID for the invoice to be paid</td>
</tr>
<tr>
<td><strong>accountId</strong></td>
<td>string</td>
<td>system</td>
<td>UUID for the account to be paid</td>
</tr>
<tr>
<td><strong>paymentId</strong></td>
<td>string</td>
<td>system</td>
<td>UUID for the payment</td>
</tr>
<tr>
<td><strong>paymentNumber</strong></td>
<td>number</td>
<td>user</td>
<td>User&#39;s ID number for the payment</td>
</tr>
<tr>
<td><strong>paymentExternalKey</strong></td>
<td>string</td>
<td>user</td>
<td>optional external key</td>
</tr>
<tr>
<td><strong>authAmonunt</strong></td>
<td>number</td>
<td>user or system</td>
<td>Total authorized amount (see below)</td>
</tr>
<tr>
<td><strong>capturedAmonunt</strong></td>
<td>number</td>
<td>user or system</td>
<td>Total captured amount (see below)</td>
</tr>
<tr>
<td><strong>purchasedAmonunt</strong></td>
<td>number</td>
<td>user or system</td>
<td>Total purchased amount (see below)</td>
</tr>
<tr>
<td><strong>refundedAmount</strong></td>
<td>number</td>
<td>user or system</td>
<td>Total refunded amount (see below)</td>
</tr>
<tr>
<td><strong>creditedAmount</strong></td>
<td>number</td>
<td>user or system</td>
<td>Total credited amount (see below)</td>
</tr>
<tr>
<td><strong>currency</strong></td>
<td>string</td>
<td>user</td>
<td>currency to be used</td>
</tr>
<tr>
<td><strong>paymentMethod</strong></td>
<td>string</td>
<td>system</td>
<td>UUID for the payment method used</td>
</tr>
<tr>
<td><strong>transactions</strong></td>
<td>list</td>
<td>system</td>
<td>list of paymentTransactions, if any (see below)</td>
</tr>
<tr>
<td><strong>paymentAttempts</strong></td>
<td>list</td>
<td>system</td>
<td>list of paymentAttempts, if any (see below)</td>
</tr>
</tbody></table>

<ul>
<li><p><strong>authAmount</strong>, <strong>capturedAmount</strong>, <strong>purchasedAmount</strong>, <strong>refundedAmount</strong>, <strong>creditedAmount</strong>: These are total amounts across all transactions associated with this Payment.</p></li>
<li><p><strong>creditedAmount</strong>: this credit represents the actual money sent back by the merchant to the user, which is extremely rare. It is unrelated to the associated invoice or account credits.</p></li>
<li><p><strong>paymentTransactions</strong>: List of transactions for this Payment. The attributes for a <code>PaymentTransaction</code> are described <a href="payment-transaction.html#payment-transaction-payment-transaction-resource">here</a>.</p></li>
<li><p><strong>paymentAttempts</strong>: Only applicable when the system is configured to retry failed attempts.</p></li>
</ul>
<h2 id='invoice-payment-transaction-resource'>Invoice Payment Transaction Resource</h2>
<p>The <code>InvoicePaymentTransaction</code> resource represents a payment transaction associated with a given <code>InvoicePayment</code>. It is identical to the <code>PaymentTransaction</code> resource except for the inclusion of the <strong>isAdjusted</strong> and <strong>adjustments</strong> attributes. The attributes for this resource object are:</p>

<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Generated by</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>transactionId</strong></td>
<td>string</td>
<td>system</td>
<td>UUID for the transaction</td>
</tr>
<tr>
<td><strong>transactionExternalKey</strong></td>
<td>string</td>
<td>user or system</td>
<td>Optional external key</td>
</tr>
<tr>
<td><strong>paymentId</strong></td>
<td>string</td>
<td>system</td>
<td>UUID for the transaction</td>
</tr>
<tr>
<td><strong>paymentExternalKey</strong></td>
<td>string</td>
<td>user or system</td>
<td>Optional external key</td>
</tr>
<tr>
<td><strong>transactionType</strong></td>
<td>string</td>
<td>user</td>
<td>Transaction type (see below)</td>
</tr>
<tr>
<td><strong>amount</strong></td>
<td>number</td>
<td>system</td>
<td>Total amount of the transaction</td>
</tr>
<tr>
<td><strong>currency</strong></td>
<td>string</td>
<td>user or system</td>
<td>Currency associated with the account</td>
</tr>
<tr>
<td><strong>effectiveDate</strong></td>
<td>string</td>
<td>user</td>
<td>Effective date of the transaction</td>
</tr>
<tr>
<td><strong>processedAmount</strong></td>
<td>number</td>
<td>system</td>
<td>The amount processed by the gateway (see below)</td>
</tr>
<tr>
<td><strong>processedCurrency</strong></td>
<td>string</td>
<td>system</td>
<td>The currency processed by the gateay (see below)</td>
</tr>
<tr>
<td><strong>status</strong></td>
<td>string</td>
<td>system</td>
<td>Transaction status (see below)</td>
</tr>
<tr>
<td><strong>gatewayErrorCode</strong></td>
<td>string</td>
<td>system</td>
<td>Error code returned by the payment gateway</td>
</tr>
<tr>
<td><strong>gatewayErrorMsg</strong></td>
<td>string</td>
<td>system</td>
<td>Error message returned by the payment gateway</td>
</tr>
<tr>
<td><strong>firstPaymentReferenceId</strong></td>
<td>string</td>
<td>system</td>
<td>Payment gateway reference</td>
</tr>
<tr>
<td><strong>secondPaymentReferenceId</strong></td>
<td>string</td>
<td>system</td>
<td>see below</td>
</tr>
<tr>
<td><strong>properties</strong></td>
<td>string</td>
<td>user</td>
<td>see below</td>
</tr>
<tr>
<td><strong>isAdjusted</strong></td>
<td>boolean</td>
<td>system</td>
<td>true if this object includes one or more InvoiceItem adjustments</td>
</tr>
<tr>
<td><strong>adjustments</strong></td>
<td>list</td>
<td>system</td>
<td>List of adjusted <code>InvoiceItem</code> resources showing adjusted amounts</td>
</tr>
</tbody></table>

<ul>
<li><p><strong>transactionType</strong>: Possible values are: AUTHORIZE, CAPTURE, CHARGEBACK, CREDIT, PURCHASE, REFUND, VOID </p></li>
<li><p><strong>processedAmount</strong>: This will often match <strong>amount</strong>, but could be different, perhaps due to currency conversion</p></li>
<li><p><strong>processedCurrency</strong>: This will often match <strong>currency</strong>, but could be different, perhaps due to currency conversion</p></li>
<li><p><strong>status</strong>: Possible values are: SUCCESS, UNKNOWN, PENDING, PAYMENT_FAILURE, PLUGIN_FAILURE, or PAYMENT_SYSTEM_OFF</p></li>
<li><p><strong>secondPaymentReferenceId</strong>: Typically the ID from the actual payment processor, when the gateway is a PSP</p></li>
<li><p><strong>properties</strong>: Plugin-specific properties to be interpreted by the plugin</p></li>
</ul>
<h2 id='invoice-payment-2'>Invoice Payment</h2>
<p>These endpoints initiate transactions on an existing InvoicePayment. Many other applicable transactions are given in the <a href="payment.html">Payment</a> section. To begin a new Payment, see <a href="account.html#account-trigger-a-payment-authorization-purchase-or-credit">Trigger a Payment</a> in the Account API. </p>
<h3 id='retrieve-a-payment-by-id'>Retrieve a payment by id</h3>
<p>Retrieves an invoice payment by its payment Id, which is given as a path parameter</p>

<p><strong>HTTP Request</strong> </p>

<p><code>GET http://127.0.0.1:8080/1.0/kb/invoicePayments/{paymentId}</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="se">\</span>
    <span class="nt">-u</span> admin:password <span class="se">\</span>
    <span class="nt">-H</span> <span class="s1">'X-Killbill-ApiKey: bob'</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s1">'X-Killbill-ApiSecret: lazar'</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s1">'Accept: application/json'</span> <span class="se">\</span>
    <span class="s1">'http://127.0.0.1:8080/1.0/kb/invoicePayments/cc7fcd4d-e701-4679-9741-41289103db83'</span> 
</code></pre></div><div class="highlight"><pre class="highlight java tab-java"><code><span class="kn">import</span> <span class="nn">org.killbill.billing.client.api.gen.InvoicePaymentApi</span><span class="o">;</span>
<span class="kd">protected</span> <span class="nc">InvoicePaymentApi</span> <span class="n">invoicePaymentApi</span><span class="o">;</span>

<span class="no">UUID</span> <span class="n">paymentId</span> <span class="o">=</span> <span class="no">UUID</span><span class="o">.</span><span class="na">fromString</span><span class="o">(</span><span class="s">"80f5bfca-e142-4320-b8f2-ae4530ca7172"</span><span class="o">);</span>
<span class="nc">Boolean</span> <span class="n">withPluginInfo</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span> <span class="c1">// Will not reflect plugin info</span>
<span class="nc">Boolean</span> <span class="n">withAttempts</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span> <span class="c1">// Will not reflect payment attempts</span>
<span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="no">NULL_PLUGIN_PROPERTIES</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

<span class="nc">InvoicePayment</span> <span class="n">invoicePayment</span> <span class="o">=</span> <span class="n">invoicePaymentApi</span><span class="o">.</span><span class="na">getInvoicePayment</span><span class="o">(</span><span class="n">paymentId</span><span class="o">,</span> 
                                                                    <span class="n">withPluginInfo</span><span class="o">,</span>
                                                                    <span class="n">withAttempts</span><span class="o">,</span>
                                                                    <span class="no">NULL_PLUGIN_PROPERTIES</span><span class="o">,</span>
                                                                    <span class="nc">AuditLevel</span><span class="o">.</span><span class="na">NONE</span><span class="o">,</span>
                                                                    <span class="n">requestOptions</span><span class="o">);</span>
</code></pre></div><div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="n">payment_id</span> <span class="o">=</span> <span class="s1">'28aef37a-7655-4351-985a-02b961ae4ac7'</span>
<span class="n">with_plugin_info</span> <span class="o">=</span> <span class="kp">false</span>
<span class="n">with_attempts</span> <span class="o">=</span> <span class="kp">false</span>

<span class="no">KillBillClient</span><span class="o">::</span><span class="no">Model</span><span class="o">::</span><span class="no">InvoicePayment</span><span class="p">.</span><span class="nf">find_by_id</span><span class="p">(</span><span class="n">payment_id</span><span class="p">,</span> 
                                                 <span class="n">with_plugin_info</span><span class="p">,</span> 
                                                 <span class="n">with_attempts</span><span class="p">,</span> 
                                                 <span class="vi">@options</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="n">invoicePaymentApi</span> <span class="o">=</span> <span class="n">killbill</span><span class="p">.</span><span class="n">api</span><span class="p">.</span><span class="n">InvoicePaymentApi</span><span class="p">()</span>
<span class="n">payment_id</span> <span class="o">=</span> <span class="s">'5e9d8b82-2664-4a36-85a1-37471a0b618a'</span>

<span class="n">invoicePaymentApi</span><span class="p">.</span><span class="n">get_invoice_payment</span><span class="p">(</span><span class="n">payment_id</span><span class="p">,</span> <span class="n">api_key</span><span class="p">,</span> <span class="n">api_secret</span><span class="p">)</span>
</code></pre></div>
<blockquote>
<p>Example Response:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"targetInvoiceId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4be34fe4-5845-4a35-afd8-632ad04cccf9"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"accountId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"8b66b9f9-bfb4-463a-86c7-e267128a294a"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"paymentId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cc7fcd4d-e701-4679-9741-41289103db83"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"paymentNumber"</span><span class="p">:</span><span class="w"> </span><span class="s2">"19"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"paymentExternalKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cc7fcd4d-e701-4679-9741-41289103db83"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"authAmount"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="nl">"capturedAmount"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="nl">"purchasedAmount"</span><span class="p">:</span><span class="w"> </span><span class="mi">500</span><span class="p">,</span><span class="w">
  </span><span class="nl">"refundedAmount"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="nl">"creditedAmount"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="nl">"currency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"USD"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"paymentMethodId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"39f3461c-5357-42f7-a8a9-ec79502fdb6b"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"transactions"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"transactionId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"6787dc2d-4f5e-49b5-9764-0070fd1238c2"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"transactionExternalKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"6787dc2d-4f5e-49b5-9764-0070fd1238c2"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"paymentId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cc7fcd4d-e701-4679-9741-41289103db83"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"paymentExternalKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cc7fcd4d-e701-4679-9741-41289103db83"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"transactionType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"PURCHASE"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">500</span><span class="p">,</span><span class="w">
      </span><span class="nl">"currency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"USD"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"effectiveDate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-07-19T20:48:34.000Z"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"processedAmount"</span><span class="p">:</span><span class="w"> </span><span class="mi">500</span><span class="p">,</span><span class="w">
      </span><span class="nl">"processedCurrency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"USD"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SUCCESS"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"gatewayErrorCode"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nl">"gatewayErrorMsg"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nl">"firstPaymentReferenceId"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nl">"secondPaymentReferenceId"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nl">"properties"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nl">"auditLogs"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nl">"paymentAttempts"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nl">"auditLogs"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p><strong>Query Parameters</strong></p>

<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Required</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>withPluginInfo</strong></td>
<td>boolean</td>
<td>no</td>
<td>false</td>
<td>if true, include plugin info</td>
</tr>
<tr>
<td><strong>withAttempts</strong></td>
<td>boolean</td>
<td>no</td>
<td>false</td>
<td>if true, include payment attempts</td>
</tr>
</tbody></table>

<p><strong>Returns</strong></p>

<p>If successful, returns a status code of 200 and an <code>InvoicePayment</code> object.</p>
<h3 id='refund-a-payment-and-adjust-the-invoice-if-needed'>Refund a payment, and adjust the invoice if needed</h3>
<p>Refunds a payment, and optionally adds the amount to one or more invoice items</p>

<p><strong>HTTP Request</strong> </p>

<p><code>POST http://127.0.0.1:8080/1.0/kb/invoicePayments/{paymentId}/refunds</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="nt">-v</span> <span class="se">\</span>
    <span class="nt">-X</span> POST <span class="se">\</span>
    <span class="nt">-u</span> admin:password <span class="se">\</span>
    <span class="nt">-H</span> <span class="s1">'X-Killbill-ApiKey: bob'</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s1">'X-Killbill-ApiSecret: lazar'</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s1">'Content-Type: application/json'</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s1">'X-Killbill-CreatedBy: demo'</span> <span class="se">\</span>
    <span class="nt">-d</span> <span class="s1">'{
          "amount": 50,
          "isAdjusted": false
        }'</span> <span class="se">\</span>
    <span class="s1">'http://127.0.0.1:8080/1.0/kb/invoicePayments/cc7fcd4d-e701-4679-9741-41289103db83/refunds'</span> 
</code></pre></div><div class="highlight"><pre class="highlight java tab-java"><code><span class="kn">import</span> <span class="nn">org.killbill.billing.client.api.gen.InvoicePaymentApi</span><span class="o">;</span>
<span class="kd">protected</span> <span class="nc">InvoicePaymentApi</span> <span class="n">invoicePaymentApi</span><span class="o">;</span>

<span class="no">UUID</span> <span class="n">paymentId</span> <span class="o">=</span> <span class="no">UUID</span><span class="o">.</span><span class="na">fromString</span><span class="o">(</span><span class="s">"45d6f4c5-21be-49b1-99c5-7b0c3c985bf0"</span><span class="o">);</span>

<span class="nc">InvoicePaymentTransaction</span> <span class="n">refund</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">InvoicePaymentTransaction</span><span class="o">();</span>
<span class="n">refund</span><span class="o">.</span><span class="na">setPaymentId</span><span class="o">(</span><span class="n">paymentId</span><span class="o">);</span>
<span class="n">refund</span><span class="o">.</span><span class="na">setAmount</span><span class="o">(</span><span class="nc">BigDecimal</span><span class="o">.</span><span class="na">ONE</span><span class="o">);</span>

<span class="no">UUID</span> <span class="n">paymentMethodId</span> <span class="o">=</span> <span class="no">UUID</span><span class="o">.</span><span class="na">fromString</span><span class="o">(</span><span class="s">"28a3ed1a-7a58-4ac2-b864-2ca723abb864"</span><span class="o">);</span>

<span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="no">NULL_PLUGIN_PROPERTIES</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

<span class="n">invoicePaymentApi</span><span class="o">.</span><span class="na">createRefundWithAdjustments</span><span class="o">(</span><span class="n">paymentId</span><span class="o">,</span> 
                                              <span class="n">refund</span><span class="o">,</span> 
                                              <span class="n">paymentMethodId</span><span class="o">,</span> 
                                              <span class="no">NULL_PLUGIN_PROPERTIES</span><span class="o">,</span> 
                                              <span class="n">requestOptions</span><span class="o">);</span>
</code></pre></div><div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="n">payment_id</span> <span class="o">=</span> <span class="s1">'8d85a8e8-c94b-438f-aac1-e8cb436b2c05'</span>
<span class="n">amount</span> <span class="o">=</span><span class="s1">'50.0'</span>
<span class="n">adjustments</span> <span class="o">=</span> <span class="kp">nil</span>
<span class="no">KillBillClient</span><span class="o">::</span><span class="no">Model</span><span class="o">::</span><span class="no">InvoicePayment</span><span class="p">.</span><span class="nf">refund</span><span class="p">(</span><span class="n">payment_id</span><span class="p">,</span> 
                                             <span class="n">amount</span><span class="p">,</span> 
                                             <span class="n">adjustments</span><span class="p">,</span> 
                                             <span class="n">user</span><span class="p">,</span> 
                                             <span class="n">reason</span><span class="p">,</span> 
                                             <span class="n">comment</span><span class="p">,</span> 
                                             <span class="n">options</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="n">invoicePaymentApi</span> <span class="o">=</span> <span class="n">killbill</span><span class="p">.</span><span class="n">api</span><span class="p">.</span><span class="n">InvoicePaymentApi</span><span class="p">()</span>
<span class="n">payment_id</span> <span class="o">=</span> <span class="s">'8d85a8e8-c94b-438f-aac1-e8cb436b2c05'</span>
<span class="n">body</span> <span class="o">=</span> <span class="n">PaymentTransaction</span><span class="p">(</span><span class="n">amount</span><span class="o">=</span><span class="mf">50.0</span><span class="p">)</span>

<span class="n">invoicePaymentApi</span><span class="p">.</span><span class="n">create_refund_with_adjustments</span><span class="p">(</span><span class="n">payment_id</span><span class="p">,</span>
                                                 <span class="n">body</span><span class="p">,</span>
                                                 <span class="n">created_by</span><span class="p">,</span>
                                                 <span class="n">api_key</span><span class="p">,</span>
                                                 <span class="n">api_secret</span><span class="p">)</span>
</code></pre></div>
<p><strong>Request Body</strong></p>

<p>An <code>InvoicePaymentTransaction</code> object, including at least the <strong>amount</strong> attribute and the <strong>isAdjusted</strong> attribute. If <strong>isAdjusted</strong> is true, then the object must also include the attribute <strong>adjustments</strong> which is a list of <code>InvoiceItem</code> objects giving the <strong>invoiceItemId</strong>, the <strong>invoiceId</strong>, and the adjusted <strong>amount</strong> for each of the adjustments to be made.</p>

<p><strong>Query Parameters</strong></p>

<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Required</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>externalPayment</strong></td>
<td>boolean</td>
<td>no</td>
<td>false</td>
<td>choose true if the payment method is external</td>
</tr>
<tr>
<td><strong>paymentMethodId</strong></td>
<td>string</td>
<td>yes</td>
<td>none</td>
<td>paymentMethod id</td>
</tr>
</tbody></table>

<p><strong>Response</strong></p>

<p>If successful, returns a status code of 201 and an empty body.</p>
<h3 id='record-a-chargeback'>Record a chargeback</h3>
<p>Creates a CHARGEBACK InvoicePaymentTransaction for a specified InvoicePayment. The InvoicePayment is identified by its <code>paymentId</code> given as a path parameter. The captured amount is reduced by the chargeback amount. If appropriate this amount will be added back to one or more invoice items.</p>

<p><strong>HTTP Request</strong> </p>

<p><code>POST http://127.0.0.1:8080/1.0/kb/invoicePayments/{paymentId}/chargebacks</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="nt">-v</span> <span class="se">\</span>
    <span class="nt">-X</span> POST <span class="se">\</span>
    <span class="nt">-u</span> admin:password <span class="se">\</span>
    <span class="nt">-H</span> <span class="s1">'X-Killbill-ApiKey: bob'</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s1">'X-Killbill-ApiSecret: lazar'</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s1">'Content-Type: application/json'</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s1">'X-Killbill-CreatedBy: demo'</span> <span class="se">\</span>
    <span class="nt">-d</span> <span class="s1">'{
          "amount": 5,
          "isAdjusted": false
        }'</span> <span class="se">\</span>
    <span class="s1">'http://127.0.0.1:8080/1.0/kb/invoicePayments/cc7fcd4d-e701-4679-9741-41289103db83/chargebacks'</span> 
</code></pre></div><div class="highlight"><pre class="highlight java tab-java"><code><span class="kn">import</span> <span class="nn">org.killbill.billing.client.api.gen.InvoicePaymentApi</span><span class="o">;</span>
<span class="kd">protected</span> <span class="nc">InvoicePaymentApi</span> <span class="n">invoicePaymentApi</span><span class="o">;</span>

<span class="no">UUID</span> <span class="n">paymentId</span> <span class="o">=</span> <span class="no">UUID</span><span class="o">.</span><span class="na">fromString</span><span class="o">(</span><span class="s">"96930ff3-82e1-4556-888a-0cb07ec120d6"</span><span class="o">);</span>

<span class="nc">InvoicePaymentTransaction</span> <span class="n">body</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">InvoicePaymentTransaction</span><span class="o">();</span>
<span class="n">body</span><span class="o">.</span><span class="na">setPaymentId</span><span class="o">(</span><span class="n">paymentId</span><span class="o">);</span>
<span class="n">body</span><span class="o">.</span><span class="na">setAmount</span><span class="o">(</span><span class="k">new</span> <span class="nc">BigDecimal</span><span class="o">(</span><span class="s">"50.00"</span><span class="o">));</span>

<span class="nc">InvoicePayment</span> <span class="n">result</span> <span class="o">=</span> <span class="n">invoicePaymentApi</span><span class="o">.</span><span class="na">createChargeback</span><span class="o">(</span><span class="n">paymentId</span><span class="o">,</span> 
                                                           <span class="n">body</span><span class="o">,</span> 
                                                           <span class="n">requestOptions</span><span class="o">);</span>
</code></pre></div><div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="n">payment_id</span> <span class="o">=</span> <span class="s1">'2276b3c9-4e51-41b2-b5bf-9ddc11582ee4'</span>
<span class="n">amount</span> <span class="o">=</span> <span class="s1">'50.0'</span>
<span class="n">currency</span> <span class="o">=</span> <span class="s1">'USD'</span>
<span class="n">effective_date</span> <span class="o">=</span> <span class="s2">"2013-08-01"</span>

<span class="no">KillBillClient</span><span class="o">::</span><span class="no">Model</span><span class="o">::</span><span class="no">InvoicePayment</span><span class="p">.</span><span class="nf">chargeback</span><span class="p">(</span><span class="n">payment_id</span><span class="p">,</span> 
                                                 <span class="n">amount</span><span class="p">,</span>
                                                 <span class="n">currency</span><span class="p">,</span>
                                                 <span class="n">effective_date</span><span class="p">,</span>
                                                 <span class="n">user</span><span class="p">,</span> 
                                                 <span class="n">reason</span><span class="p">,</span>
                                                 <span class="n">comment</span><span class="p">,</span> 
                                                 <span class="n">options</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="n">invoicePaymentApi</span> <span class="o">=</span> <span class="n">killbill</span><span class="p">.</span><span class="n">api</span><span class="p">.</span><span class="n">InvoicePaymentApi</span><span class="p">()</span>
<span class="n">payment_id</span> <span class="o">=</span> <span class="s">'2276b3c9-4e51-41b2-b5bf-9ddc11582ee4'</span>
<span class="n">body</span> <span class="o">=</span> <span class="n">PaymentTransaction</span><span class="p">(</span><span class="n">amount</span><span class="o">=</span><span class="mf">50.0</span><span class="p">,</span> <span class="n">currency</span><span class="o">=</span><span class="s">'USD'</span><span class="p">)</span>

<span class="n">invoicePaymentApi</span><span class="p">.</span><span class="n">create_chargeback</span><span class="p">(</span><span class="n">payment_id</span><span class="p">,</span> 
                                    <span class="n">body</span><span class="p">,</span> 
                                    <span class="n">created_by</span><span class="p">,</span> 
                                    <span class="n">api_key</span><span class="p">,</span> 
                                    <span class="n">api_secret</span><span class="p">)</span>
</code></pre></div>
<p><strong>Request Body</strong></p>

<p>An <code>InvoicePaymentTransaction</code> object, including at least the <strong>amount</strong> attribute and the <strong>isAdjusted</strong> attribute. If <strong>isAdjusted</strong> is true, then the object must also include the attribute <strong>adjustments</strong> which is a list of <code>InvoiceItem</code> objects giving the <strong>invoiceItemId</strong>, the <strong>invoiceId</strong>, and the adjusted <strong>amount</strong> for each of the adjustments to be made.</p>

<p><strong>Query Parameters</strong></p>

<p>None.</p>

<p><strong>Response</strong></p>

<p>If successful, returns a status code of 201 and an empty body.</p>
<h3 id='record-a-chargeback-reversal'>Record a chargeback reversal</h3>
<p>Reverses a CHARGEBACK InvoicePaymentTransaction, if permitted by the Payment plugin. The chargeback amount is added back to the captured amount. The payment is identified by its <code>paymentId</code> which is given as a path parameter.</p>

<p><strong>HTTP Request</strong> </p>

<p><code>POST http://127.0.0.1:8080/1.0/kb/invoicePayments/{paymentId}/chargebackReversals</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="nt">-v</span> <span class="se">\</span>
    <span class="nt">-X</span> POST <span class="se">\</span>
    <span class="nt">-u</span> admin:password <span class="se">\</span>
    <span class="nt">-H</span> <span class="s1">'X-Killbill-ApiKey: bob'</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s1">'X-Killbill-ApiSecret: lazar'</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s1">'Content-Type: application/json'</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s1">'X-Killbill-CreatedBy: demo'</span> <span class="se">\</span>
    <span class="nt">-d</span> <span class="s1">'{
          "transactionExternalKey": "a335f7d2-e115-436f-8c63-2b0114d974de",
          "paymentId": "cc7fcd4d-e701-4679-9741-41289103db83",
          "effectiveDate": "2018-07-20T15:05:36.853Z"        
        }'</span> <span class="se">\</span>
    <span class="s1">'http://127.0.0.1:8080/1.0/kb/invoicePayments/cc7fcd4d-e701-4679-9741-41289103db83/chargebackReversals'</span> 
</code></pre></div><div class="highlight"><pre class="highlight java tab-java"><code><span class="no">TODO</span>
</code></pre></div><div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="n">payment_id</span> <span class="o">=</span> <span class="s1">'7a5d4997-5d44-4a82-8371-a410ea5615f4'</span>
<span class="n">chargeback_transaction_external_key</span> <span class="o">=</span> <span class="s1">'99c45d07-abe4-4bc7-a207-0524548c1b08'</span>
<span class="n">effective_date</span> <span class="o">=</span> <span class="s2">"2013-08-01"</span>

<span class="no">KillBillClient</span><span class="o">::</span><span class="no">Model</span><span class="o">::</span><span class="no">InvoicePayment</span><span class="p">.</span><span class="nf">chargeback_reversal</span><span class="p">(</span><span class="n">payment_id</span><span class="p">,</span>
                                                          <span class="n">chargeback_transaction_external_key</span><span class="p">,</span> 
                                                          <span class="n">effective_date</span><span class="p">,</span> 
                                                          <span class="n">user</span><span class="p">,</span> 
                                                          <span class="n">reason</span><span class="p">,</span> 
                                                          <span class="n">comment</span><span class="p">,</span> 
                                                          <span class="n">options</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="n">invoicePaymentApi</span> <span class="o">=</span> <span class="n">killbill</span><span class="p">.</span><span class="n">api</span><span class="p">.</span><span class="n">InvoicePaymentApi</span><span class="p">()</span>
<span class="n">payment_id</span> <span class="o">=</span> <span class="s">'7a5d4997-5d44-4a82-8371-a410ea5615f4'</span>
<span class="n">transaction_external_key</span> <span class="o">=</span> <span class="s">'99c45d07-abe4-4bc7-a207-0524548c1b08'</span>
<span class="n">body</span> <span class="o">=</span> <span class="n">PaymentTransaction</span><span class="p">(</span><span class="n">amount</span><span class="o">=</span><span class="mf">50.0</span><span class="p">,</span> 
                          <span class="n">currency</span><span class="o">=</span><span class="s">'USD'</span><span class="p">,</span> 
                          <span class="n">transaction_external_key</span><span class="o">=</span><span class="n">transaction_external_key</span><span class="p">)</span>

<span class="n">invoicePaymentApi</span><span class="p">.</span><span class="n">create_chargeback_reversal</span><span class="p">(</span><span class="n">payment_id</span><span class="p">,</span> 
                                             <span class="n">body</span><span class="p">,</span> 
                                             <span class="n">created_by</span><span class="p">,</span> 
                                             <span class="n">api_key</span><span class="p">,</span> 
                                             <span class="n">api_secret</span><span class="p">)</span>
</code></pre></div>
<p><strong>Request Body</strong></p>

<p>An <code>InvoicePaymentTransaction</code> object, including at least the <strong>amount</strong> attribute and the <strong>isAdjusted</strong> attribute. If <strong>isAdjusted</strong> is true, then the object must also include the attribute <strong>adjustments</strong> which is a list of <code>InvoiceItem</code> objects giving the <strong>invoiceItemId</strong>, the <strong>invoiceId</strong>, and the adjusted <strong>amount</strong> for each of the adjustments to be made.</p>

<p><strong>Query Parameters</strong></p>

<p>None.</p>

<p><strong>Response</strong></p>

<p>If successful, returns a status code of 201 and an empty body.</p>
<h3 id='complete-an-existing-transaction'>Complete an existing transaction</h3>
<p>Completes any existing InvoicePaymentTransaction that is in a PENDING state, based on its <code>paymentId</code> given as a path parameter.</p>

<p><strong>HTTP Request</strong> </p>

<p><code>PUT http://127.0.0.1:8080/1.0/kb/invoicePayments/{paymentId}</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="nt">-v</span> <span class="se">\</span>
    <span class="nt">-X</span> PUT <span class="se">\</span>
    <span class="nt">-u</span> admin:password <span class="se">\</span>
    <span class="nt">-H</span> <span class="s1">'X-Killbill-ApiKey: bob'</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s1">'X-Killbill-ApiSecret: lazar'</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s1">'Content-Type: application/json'</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s1">'X-Killbill-CreatedBy: demo'</span> <span class="se">\</span>
    <span class="nt">-d</span> <span class="s1">'{
            "paymentId": "cc7fcd4d-e701-4679-9741-41289103db83"
        }'</span> <span class="se">\</span>
    <span class="s1">'http://127.0.0.1:8080/1.0/kb/invoicePayments/cc7fcd4d-e701-4679-9741-41289103db83'</span> 
</code></pre></div><div class="highlight"><pre class="highlight java tab-java"><code><span class="kn">import</span> <span class="nn">org.killbill.billing.client.api.gen.InvoicePaymentApi</span><span class="o">;</span>
<span class="kd">protected</span> <span class="nc">InvoicePaymentApi</span> <span class="n">invoicePaymentApi</span><span class="o">;</span>

<span class="no">UUID</span> <span class="n">paymentId</span> <span class="o">=</span> <span class="no">UUID</span><span class="o">.</span><span class="na">fromString</span><span class="o">(</span><span class="s">"80f5bfca-e142-4320-b8f2-ae4530ca7172"</span><span class="o">);</span>
<span class="nc">PaymentTransaction</span> <span class="n">body</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">PaymentTransaction</span><span class="o">();</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="no">NULL_PLUGIN_NAMES</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
<span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="no">NULL_PLUGIN_PROPERTIES</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

<span class="n">invoicePaymentApi</span><span class="o">.</span><span class="na">completeInvoicePaymentTransaction</span><span class="o">(</span><span class="n">paymentId</span><span class="o">,</span> 
                                                    <span class="n">body</span><span class="o">,</span> 
                                                    <span class="no">NULL_PLUGIN_NAMES</span><span class="o">,</span> 
                                                    <span class="no">NULL_PLUGIN_PROPERTIES</span><span class="o">,</span> 
                                                    <span class="n">requestOptions</span><span class="o">);</span>
</code></pre></div><div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="n">payment_id</span> <span class="o">=</span> <span class="s1">'2276b3c9-4e51-41b2-b5bf-9ddc11582ee4'</span>

<span class="no">KillBillClient</span><span class="o">::</span><span class="no">Model</span><span class="o">::</span><span class="no">InvoicePayment</span><span class="p">.</span><span class="nf">complete_invoice_payment_transaction</span><span class="p">(</span><span class="n">payment_id</span><span class="p">,</span> 
                                                                           <span class="n">user</span><span class="p">,</span> 
                                                                           <span class="n">reason</span><span class="p">,</span> 
                                                                           <span class="n">comment</span><span class="p">,</span> 
                                                                           <span class="n">options</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="n">invoicePaymentApi</span> <span class="o">=</span> <span class="n">killbill</span><span class="p">.</span><span class="n">api</span><span class="p">.</span><span class="n">InvoicePaymentApi</span><span class="p">()</span>
<span class="n">body</span> <span class="o">=</span> <span class="n">PaymentTransaction</span><span class="p">(</span><span class="n">payment_id</span><span class="o">=</span><span class="n">payment_id</span><span class="p">)</span>

<span class="n">invoicePaymentApi</span><span class="p">.</span><span class="n">complete_invoice_payment_transaction</span><span class="p">(</span><span class="n">payment_id</span><span class="p">,</span> 
                                                       <span class="n">body</span><span class="p">,</span> 
                                                       <span class="n">created_by</span><span class="p">,</span> 
                                                       <span class="n">api_key</span><span class="p">,</span> 
                                                       <span class="n">api_secret</span><span class="p">)</span>
</code></pre></div>
<p><strong>Query Parameters</strong></p>

<p>None.</p>

<p><strong>Response</strong></p>

<p>If successful, returns a status code of 204 and an empty body.</p>
<h2 id='custom-fields'>Custom Fields</h2>
<p>Custom fields are <code>{key, value}</code> attributes that can be attached to any customer resource. In particular they can be added to InvoicePayment objects. For details on Custom Fields see <a href="custom-field.html#custom-field">Custom Field</a>.</p>
<h3 id='add-custom-fields-to-invoice-payment'>Add custom fields to invoice payment</h3>
<p>Adds one or more custom fields to an InvoicePayment object. Existing custom fields are not modified.</p>

<p><strong>HTTP Request</strong> </p>

<p><code>POST http://127.0.0.1:8080/1.0/kb/invoicePayments/{paymentId}/customFields</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="nt">-v</span> <span class="se">\</span>
    <span class="nt">-X</span> POST <span class="se">\</span>
    <span class="nt">-u</span> admin:password <span class="se">\</span>
    <span class="nt">-H</span> <span class="s1">'X-Killbill-ApiKey: bob'</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s1">'X-Killbill-ApiSecret: lazar'</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s1">'Content-Type: application/json'</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s1">'X-Killbill-CreatedBy: demo'</span> <span class="se">\</span>
    <span class="nt">-d</span> <span class="s1">'[{ 
            "name": "Test Custom Fields",
            "value": "test_value"
    }]'</span> <span class="se">\</span>
    <span class="s1">'http://127.0.0.1:8080/1.0/kb/invoicePayments/2495e35e-2b96-434c-8877-62dbbf20f7e9/customFields'</span> 
</code></pre></div><div class="highlight"><pre class="highlight java tab-java"><code><span class="kn">import</span> <span class="nn">org.killbill.billing.client.api.gen.InvoicePaymentApi</span><span class="o">;</span>
<span class="kd">protected</span> <span class="nc">InvoicePaymentApi</span> <span class="n">invoicePaymentApi</span><span class="o">;</span>

<span class="no">UUID</span> <span class="n">paymentId</span> <span class="o">=</span> <span class="no">UUID</span><span class="o">.</span><span class="na">fromString</span><span class="o">(</span><span class="s">"59860a0d-c032-456d-a35e-3a48fe8579e5"</span><span class="o">);</span>
<span class="kd">final</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">AuditLog</span><span class="o">&gt;</span> <span class="no">EMPTY_AUDIT_LOGS</span> <span class="o">=</span> <span class="nc">Collections</span><span class="o">.</span><span class="na">emptyList</span><span class="o">();</span>

<span class="nc">CustomFields</span> <span class="n">customFields</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CustomFields</span><span class="o">();</span>
<span class="n">customFields</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="nc">CustomField</span><span class="o">(</span><span class="kc">null</span><span class="o">,</span> 
                                 <span class="n">paymentId</span><span class="o">,</span> 
                                 <span class="nc">ObjectType</span><span class="o">.</span><span class="na">INVOICE_PAYMENT</span><span class="o">,</span> 
                                 <span class="s">"Test Custom Field"</span><span class="o">,</span> 
                                 <span class="s">"test_value"</span><span class="o">,</span> 
                                 <span class="no">EMPTY_AUDIT_LOGS</span><span class="o">));</span>

<span class="n">invoicePaymentApi</span><span class="o">.</span><span class="na">createInvoicePaymentCustomFields</span><span class="o">(</span><span class="n">paymentId</span><span class="o">,</span> 
                                                   <span class="n">customFields</span><span class="o">,</span> 
                                                   <span class="n">requestOptions</span><span class="o">);</span>
</code></pre></div><div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="n">custom_field</span> <span class="o">=</span> <span class="no">KillBillClient</span><span class="o">::</span><span class="no">Model</span><span class="o">::</span><span class="no">CustomFieldAttributes</span><span class="p">.</span><span class="nf">new</span>
<span class="n">custom_field</span><span class="p">.</span><span class="nf">object_type</span> <span class="o">=</span> <span class="s1">'INVOICE_PAYMENT'</span>
<span class="n">custom_field</span><span class="p">.</span><span class="nf">name</span> <span class="o">=</span> <span class="s1">'Test Custom Field'</span>
<span class="n">custom_field</span><span class="p">.</span><span class="nf">value</span> <span class="o">=</span> <span class="s1">'test_value'</span>

<span class="n">invoice_payment</span><span class="p">.</span><span class="nf">add_custom_field</span><span class="p">(</span><span class="n">custom_field</span><span class="p">,</span> 
                                 <span class="n">user</span><span class="p">,</span>
                                 <span class="n">reason</span><span class="p">,</span>
                                 <span class="n">comment</span><span class="p">,</span>
                                 <span class="n">options</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="n">invoicePaymentApi</span> <span class="o">=</span> <span class="n">killbill</span><span class="p">.</span><span class="n">api</span><span class="p">.</span><span class="n">InvoicePaymentApi</span><span class="p">()</span>
<span class="n">body</span> <span class="o">=</span> <span class="n">CustomField</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">'Test Custom Field'</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s">'test_value'</span><span class="p">)</span>

<span class="n">invoicePaymentApi</span><span class="p">.</span><span class="n">create_invoice_payment_custom_fields</span><span class="p">(</span><span class="n">payment_id</span><span class="p">,</span>
                                                       <span class="p">[</span><span class="n">body</span><span class="p">],</span>
                                                       <span class="n">created_by</span><span class="p">,</span>
                                                       <span class="n">api_key</span><span class="p">,</span>
                                                       <span class="n">api_secret</span><span class="p">)</span>

</code></pre></div>
<p><strong>Request Body</strong></p>

<p>A JSON string representing the custom field object or objects to be added.</p>

<p><strong>Query Parameters</strong></p>

<p>None.</p>

<p><strong>Response</strong></p>

<p>If successful, returns a status code of 201 and an empty body.</p>
<h3 id='retrieve-invoice-payment-custom-fields'>Retrieve invoice payment custom fields</h3>
<p>Retrieves the custom fields associated with an InvoicePayment object</p>

<p><strong>HTTP Request</strong> </p>

<p><code>GET http://127.0.0.1:8080/1.0/kb/invoicePayments/{paymentId}/customFields</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="se">\</span>
    <span class="nt">-u</span> admin:password <span class="se">\</span>
    <span class="nt">-H</span> <span class="s1">'X-Killbill-ApiKey: bob'</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s1">'X-Killbill-ApiSecret: lazar'</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s1">'Accept: application/json'</span> <span class="se">\</span>
    <span class="s1">'http://127.0.0.1:8080/1.0/kb/invoicePayments/2495e35e-2b96-434c-8877-62dbbf20f7e9/customFields'</span> 
</code></pre></div><div class="highlight"><pre class="highlight java tab-java"><code><span class="kn">import</span> <span class="nn">org.killbill.billing.client.api.gen.InvoicePaymentApi</span><span class="o">;</span>
<span class="kd">protected</span> <span class="nc">InvoicePaymentApi</span> <span class="n">invoicePaymentApi</span><span class="o">;</span>

<span class="no">UUID</span> <span class="n">paymentId</span> <span class="o">=</span> <span class="no">UUID</span><span class="o">.</span><span class="na">fromString</span><span class="o">(</span><span class="s">"59860a0d-c032-456d-a35e-3a48fe8579e5"</span><span class="o">);</span>

<span class="nc">List</span><span class="o">&lt;</span><span class="nc">CustomField</span><span class="o">&gt;</span> <span class="n">customFields</span> <span class="o">=</span> <span class="n">invoicePaymentApi</span><span class="o">.</span><span class="na">getInvoicePaymentCustomFields</span><span class="o">(</span><span class="n">paymentId</span><span class="o">,</span>
                                                                                 <span class="nc">AuditLevel</span><span class="o">.</span><span class="na">NONE</span><span class="o">,</span>
                                                                                 <span class="n">requestOptions</span><span class="o">);</span>
</code></pre></div><div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="n">audit</span> <span class="o">=</span> <span class="s1">'NONE'</span>

<span class="n">invoice_payment</span><span class="p">.</span><span class="nf">custom_fields</span><span class="p">(</span><span class="n">audit</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="n">invoicePaymentApi</span> <span class="o">=</span> <span class="n">killbill</span><span class="p">.</span><span class="n">api</span><span class="p">.</span><span class="n">InvoicePaymentApi</span><span class="p">()</span>
<span class="n">payment_id</span> <span class="o">=</span> <span class="s">'f33e0adc-78df-438a-b920-aaacd7f8597a'</span>

<span class="n">invoicePaymentApi</span><span class="p">.</span><span class="n">get_invoice_payment_custom_fields</span><span class="p">(</span><span class="n">payment_id</span><span class="p">,</span> <span class="n">api_key</span><span class="p">,</span> <span class="n">api_secret</span><span class="p">)</span>
</code></pre></div>
<blockquote>
<p>Example Response:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"customFieldId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3fbf75aa-6f22-4a02-974b-55eeded2cf6b"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"objectId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2495e35e-2b96-434c-8877-62dbbf20f7e9"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"objectType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"PAYMENT"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Test Custom Field"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"test_value"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"auditLogs"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div>
<p><strong>Query Parameters</strong></p>

<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Required</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>audit</strong></td>
<td>string</td>
<td>no</td>
<td>&quot;NONE&quot;</td>
<td>Level of audit information to return</td>
</tr>
</tbody></table>

<p>Audit information options are &quot;NONE&quot;, &quot;MINIMAL&quot; (only inserts), or &quot;FULL&quot;.</p>

<p><strong>Response</strong></p>

<p>If successful, returns a status code of 200 and a list of custom field objects</p>
<h3 id='modify-custom-fields-for-an-invoice-payment'>Modify custom fields for an invoice payment</h3>
<p>Modifies the custom fields associated with an InvoicePayment object</p>

<p><strong>HTTP Request</strong> </p>

<p><code>PUT http://127.0.0.1:8080/1.0/kb/invoicePayments/{paymentId}/customFields</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="nt">-v</span> <span class="se">\</span>
    <span class="nt">-X</span> PUT <span class="se">\</span>
    <span class="nt">-u</span> admin:password <span class="se">\</span>
    <span class="nt">-H</span> <span class="s1">'X-Killbill-ApiKey: bob'</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s1">'X-Killbill-ApiSecret: lazar'</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s1">'Content-Type: application/json'</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s1">'X-Killbill-CreatedBy: demo'</span> <span class="se">\</span>
    <span class="nt">-d</span> <span class="s1">'[{ 
            "customFieldId": "e2408cac-931b-43eb-855b-9f2902615c39",
            "value": "NewValue"
    }]'</span> <span class="se">\</span>
    <span class="s1">'http://127.0.0.1:8080/1.0/kb/invoicePayments/2495e35e-2b96-434c-8877-62dbbf20f7e9/customFields'</span> 
</code></pre></div><div class="highlight"><pre class="highlight java tab-java"><code><span class="kn">import</span> <span class="nn">org.killbill.billing.client.api.gen.InvoicePaymentApi</span><span class="o">;</span>
<span class="kd">protected</span> <span class="nc">InvoicePaymentApi</span> <span class="n">invoicePaymentApi</span><span class="o">;</span>

<span class="no">UUID</span> <span class="n">paymentId</span> <span class="o">=</span> <span class="no">UUID</span><span class="o">.</span><span class="na">fromString</span><span class="o">(</span><span class="s">"59860a0d-c032-456d-a35e-3a48fe8579e5"</span><span class="o">);</span>
<span class="no">UUID</span> <span class="n">customFieldsId</span> <span class="o">=</span> <span class="no">UUID</span><span class="o">.</span><span class="na">fromString</span><span class="o">(</span><span class="s">"9913e0f6-b5ef-498b-ac47-60e1626eba8f"</span><span class="o">);</span>

<span class="nc">CustomField</span> <span class="n">customFieldModified</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CustomField</span><span class="o">();</span>
<span class="n">customFieldModified</span><span class="o">.</span><span class="na">setCustomFieldId</span><span class="o">(</span><span class="n">customFieldsId</span><span class="o">);</span>
<span class="n">customFieldModified</span><span class="o">.</span><span class="na">setValue</span><span class="o">(</span><span class="s">"NewValue"</span><span class="o">);</span>

<span class="n">invoicePaymentApi</span><span class="o">.</span><span class="na">modifyInvoicePaymentCustomFields</span><span class="o">(</span><span class="n">paymentId</span><span class="o">,</span> 
                                                   <span class="n">customFieldModified</span><span class="o">,</span> 
                                                   <span class="n">requestOptions</span><span class="o">);</span>
</code></pre></div><div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="n">custom_field</span><span class="p">.</span><span class="nf">custom_field_id</span> <span class="o">=</span> <span class="s1">'7fb3dde7-0911-4477-99e3-69d142509bb9'</span>
<span class="n">custom_field</span><span class="p">.</span><span class="nf">name</span> <span class="o">=</span> <span class="s1">'Test Modify'</span>
<span class="n">custom_field</span><span class="p">.</span><span class="nf">value</span> <span class="o">=</span> <span class="s1">'test_modify_value'</span>

<span class="n">invoice_payment</span><span class="p">.</span><span class="nf">modify_custom_field</span><span class="p">(</span><span class="n">custom_field</span><span class="p">,</span>                                                                                            
                                    <span class="n">user</span><span class="p">,</span> 
                                    <span class="n">reason</span><span class="p">,</span>
                                    <span class="n">comment</span><span class="p">,</span> 
                                    <span class="n">options</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="n">invoicePaymentApi</span> <span class="o">=</span> <span class="n">killbill</span><span class="p">.</span><span class="n">api</span><span class="p">.</span><span class="n">InvoicePaymentApi</span><span class="p">()</span>
<span class="n">payment_id</span> <span class="o">=</span> <span class="s">'f33e0adc-78df-438a-b920-aaacd7f8597a'</span>
<span class="n">custom_field_id</span> <span class="o">=</span> <span class="s">'9913e0f6-b5ef-498b-ac47-60e1626eba8f'</span>
<span class="n">body</span> <span class="o">=</span> <span class="n">CustomField</span><span class="p">(</span><span class="n">custom_field_id</span><span class="o">=</span><span class="n">custom_field_id</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">'Test Modify'</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s">'test_modify_value'</span><span class="p">)</span>

<span class="n">invoicePaymentApi</span><span class="p">.</span><span class="n">modify_invoice_payment_custom_fields</span><span class="p">(</span><span class="n">payment_id</span><span class="p">,</span>
                                                       <span class="p">[</span><span class="n">body</span><span class="p">],</span>
                                                       <span class="n">created_by</span><span class="p">,</span>
                                                       <span class="n">api_key</span><span class="p">,</span>
                                                       <span class="n">api_secret</span><span class="p">)</span>
</code></pre></div>
<p><strong>Requst Body</strong></p>

<p>A JSON string representing a list of custom fields to substitute for the existing ones.</p>

<p><strong>Query Parameters</strong></p>

<p>None.</p>

<p><strong>Response</strong></p>

<p>If successful, returns a status code of 204 and an empty body.</p>
<h3 id='remove-custom-fields-from-an-invoice-payment'>Remove custom fields from an invoice payment</h3>
<p>Removes a specified set of custom fields from an <code>InvoicePayment</code> object</p>

<p><strong>HTTP Request</strong> </p>

<p><code>DELETE http://127.0.0.1:8080/1.0/kb/invoicePayments/{paymentId}/customFields</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="nt">-v</span> <span class="se">\</span>
    <span class="nt">-X</span> DELETE <span class="se">\</span>
    <span class="nt">-u</span> admin:password <span class="se">\</span>
    <span class="nt">-H</span> <span class="s1">'X-Killbill-ApiKey: bob'</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s1">'X-Killbill-ApiSecret: lazar'</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s1">'X-Killbill-CreatedBy: demo'</span> <span class="se">\</span>
    <span class="s1">'http://127.0.0.1:8080/1.0/kb/invoicePayments/2495e35e-2b96-434c-8877-62dbbf20f7e9/customFields?customField=e2408cac-931b-43eb-855b-9f2902615c39'</span> 
</code></pre></div><div class="highlight"><pre class="highlight java tab-java"><code><span class="kn">import</span> <span class="nn">org.killbill.billing.client.api.gen.InvoicePaymentApi</span><span class="o">;</span>
<span class="kd">protected</span> <span class="nc">InvoicePaymentApi</span> <span class="n">invoicePaymentApi</span><span class="o">;</span>

<span class="no">UUID</span> <span class="n">paymentId</span> <span class="o">=</span> <span class="no">UUID</span><span class="o">.</span><span class="na">fromString</span><span class="o">(</span><span class="s">"59860a0d-c032-456d-a35e-3a48fe8579e5"</span><span class="o">);</span>
<span class="no">UUID</span> <span class="n">customFieldsId</span> <span class="o">=</span> <span class="no">UUID</span><span class="o">.</span><span class="na">fromString</span><span class="o">(</span><span class="s">"9913e0f6-b5ef-498b-ac47-60e1626eba8f"</span><span class="o">);</span>

<span class="n">invoicePaymentApi</span><span class="o">.</span><span class="na">deleteInvoicePaymentCustomFields</span><span class="o">(</span><span class="n">paymentId</span><span class="o">,</span> 
                                                   <span class="n">customFieldsId</span><span class="o">,</span> 
                                                   <span class="n">requestOptions</span><span class="o">);</span>
</code></pre></div><div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="n">custom_field_id</span> <span class="o">=</span> <span class="n">custom_field</span><span class="p">.</span><span class="nf">id</span>

<span class="n">invoice_payment</span><span class="p">.</span><span class="nf">remove_custom_field</span><span class="p">(</span><span class="n">custom_field_id</span><span class="p">,</span>                                                                                            
                                    <span class="n">user</span><span class="p">,</span> 
                                    <span class="n">reason</span><span class="p">,</span>
                                    <span class="n">comment</span><span class="p">,</span> 
                                    <span class="n">options</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="n">invoicePaymentApi</span> <span class="o">=</span> <span class="n">killbill</span><span class="p">.</span><span class="n">api</span><span class="p">.</span><span class="n">InvoicePaymentApi</span><span class="p">()</span>
<span class="n">payment_id</span> <span class="o">=</span> <span class="s">'f33e0adc-78df-438a-b920-aaacd7f8597a'</span>
<span class="n">custom_field_id</span> <span class="o">=</span> <span class="s">'9913e0f6-b5ef-498b-ac47-60e1626eba8f'</span>
<span class="n">custom_field</span> <span class="o">=</span> <span class="p">[</span><span class="n">custom_field_id</span><span class="p">]</span>
<span class="n">invoicePaymentApi</span><span class="p">.</span><span class="n">delete_invoice_payment_custom_fields</span><span class="p">(</span><span class="n">payment_id</span><span class="p">,</span>
                                                       <span class="n">created_by</span><span class="p">,</span>
                                                       <span class="n">api_key</span><span class="p">,</span>
                                                       <span class="n">api_secret</span><span class="p">,</span>
                                                       <span class="n">custom_field</span><span class="o">=</span><span class="n">custom_field</span><span class="p">)</span>
</code></pre></div>
<p><strong>Query Parameters</strong></p>

<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Required</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>customField</strong></td>
<td>string</td>
<td>yes</td>
<td>none</td>
<td>Comma separated list of custom field object IDs that should be deleted.</td>
</tr>
</tbody></table>

<p><strong>Response</strong></p>

<p>If successful, returns a status code of 204 and an empty body.</p>
<h2 id='tags'>Tags</h2>
<p>See <a href="account.html#account-tags">Account Tags</a> for an introduction.</p>

<p>The are no <code>system</code> tags applicable to an InvoicePayment.</p>
<h3 id='add-tags-to-an-invoice-payment'>Add tags to an invoice payment</h3>
<p>Adds one or more tags to an invoice payment object. The tag definitions must already exist.</p>

<p><strong>HTTP Request</strong> </p>

<p><code>POST http://127.0.0.1:8080/1.0/kb/invoicePayments/{paymentId}/tags</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="nt">-v</span> <span class="se">\</span>
    <span class="nt">-X</span> POST <span class="se">\</span>
    <span class="nt">-u</span> admin:password <span class="se">\</span>
    <span class="nt">-H</span> <span class="s1">'X-Killbill-ApiKey: bob'</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s1">'X-Killbill-ApiSecret: lazar'</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s1">'Content-Type: application/json'</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s1">'X-Killbill-CreatedBy: demo'</span> <span class="se">\</span>
    <span class="nt">-d</span> <span class="s1">'[
            "353752dd-9041-4450-b782-a8bb03a923c8"
        ]'</span> <span class="se">\</span>
    <span class="s1">'http://127.0.0.1:8080/1.0/kb/invoicePayments/cc7fcd4d-e701-4679-9741-41289103db83/tags'</span> 
</code></pre></div><div class="highlight"><pre class="highlight java tab-java"><code><span class="kn">import</span> <span class="nn">org.killbill.billing.client.api.gen.InvoicePaymentApi</span><span class="o">;</span>
<span class="kd">protected</span> <span class="nc">InvoicePaymentApi</span> <span class="n">invoicePaymentApi</span><span class="o">;</span>

<span class="no">UUID</span> <span class="n">paymentId</span> <span class="o">=</span> <span class="no">UUID</span><span class="o">.</span><span class="na">fromString</span><span class="o">(</span><span class="s">"45d6f4c5-21be-49b1-99c5-7b0c3c985bf0"</span><span class="o">);</span>

<span class="no">UUID</span> <span class="n">tagDefinitionId</span> <span class="o">=</span> <span class="no">UUID</span><span class="o">.</span><span class="na">fromString</span><span class="o">(</span><span class="s">"353752dd-9041-4450-b782-a8bb03a923c8"</span><span class="o">);</span>

<span class="nc">Tags</span> <span class="n">result</span> <span class="o">=</span> <span class="n">invoicePaymentApi</span><span class="o">.</span><span class="na">createInvoicePaymentTags</span><span class="o">(</span><span class="n">paymentId</span><span class="o">,</span> 
                                                         <span class="nc">List</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="n">tagDefinitionId</span><span class="o">),</span> 
                                                         <span class="n">requestOptions</span><span class="o">);</span>
</code></pre></div><div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="n">tag_name</span> <span class="o">=</span> <span class="s1">'foo'</span>

<span class="n">invoice_payment</span><span class="p">.</span><span class="nf">add_tag</span><span class="p">(</span><span class="n">tag_name</span><span class="p">,</span>
                        <span class="n">user</span><span class="p">,</span>
                        <span class="n">reason</span><span class="p">,</span>
                        <span class="n">comment</span><span class="p">,</span>
                        <span class="n">options</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="n">invoicePaymentApi</span> <span class="o">=</span> <span class="n">killbill</span><span class="p">.</span><span class="n">api</span><span class="p">.</span><span class="n">InvoicePaymentApi</span><span class="p">()</span>
<span class="n">payment_id</span> <span class="o">=</span> <span class="s">'8d85a8e8-c94b-438f-aac1-e8cb436b2c05'</span>
<span class="n">tag</span> <span class="o">=</span> <span class="p">[</span><span class="s">"353752dd-9041-4450-b782-a8bb03a923c8"</span><span class="p">]</span>

<span class="n">invoicePaymentApi</span><span class="p">.</span><span class="n">create_invoice_payment_tags</span><span class="p">(</span><span class="n">payment_id</span><span class="p">,</span>
                                              <span class="n">tag</span><span class="p">,</span>
                                              <span class="n">created_by</span><span class="p">,</span>
                                              <span class="n">api_key</span><span class="p">,</span>
                                              <span class="n">api_secret</span><span class="p">)</span>
</code></pre></div>
<p><strong>Request Body</strong></p>

<p>Provides a list of tag definition Ids in JSON format</p>

<p><strong>Query Parameters</strong></p>

<p>None.</p>

<p><strong>Response</strong></p>

<p>If successful, returns a status code of 201 and an empty body.</p>
<h3 id='retrieve-invoice-payment-tags'>Retrieve invoice payment tags</h3>
<p>Retrieves all tags attached to this InvoicePayment.</p>

<p><strong>HTTP Request</strong> </p>

<p><code>GET http://127.0.0.1:8080/1.0/kb/invoicePayments/{paymentId}/tags</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="se">\</span>
    <span class="nt">-u</span> admin:password <span class="se">\</span>
    <span class="nt">-H</span> <span class="s1">'X-Killbill-ApiKey: bob'</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s1">'X-Killbill-ApiSecret: lazar'</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s1">'Accept: application/json'</span> <span class="se">\</span>
    <span class="s1">'http://127.0.0.1:8080/1.0/kb/invoicePayments/cc7fcd4d-e701-4679-9741-41289103db83/tags'</span> 
</code></pre></div><div class="highlight"><pre class="highlight java tab-java"><code><span class="kn">import</span> <span class="nn">org.killbill.billing.client.api.gen.InvoicePaymentApi</span><span class="o">;</span>
<span class="kd">protected</span> <span class="nc">InvoicePaymentApi</span> <span class="n">invoicePaymentApi</span><span class="o">;</span>

<span class="no">UUID</span> <span class="n">paymentId</span> <span class="o">=</span> <span class="no">UUID</span><span class="o">.</span><span class="na">fromString</span><span class="o">(</span><span class="s">"e659f0f3-745c-46d5-953c-28fe9282fc7d"</span><span class="o">);</span>

<span class="nc">Boolean</span> <span class="n">includedDeleted</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span> <span class="c1">// Will not include deleted tags</span>

<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Tag</span><span class="o">&gt;</span> <span class="n">tags</span> <span class="o">=</span> <span class="n">invoicePaymentApi</span><span class="o">.</span><span class="na">getInvoicePaymentTags</span><span class="o">(</span><span class="n">paymentId</span><span class="o">,</span> 
                                                         <span class="n">includedDeleted</span><span class="o">,</span> 
                                                         <span class="nc">AuditLevel</span><span class="o">.</span><span class="na">FULL</span><span class="o">,</span> 
                                                         <span class="n">requestOptions</span><span class="o">);</span>
</code></pre></div><div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="n">included_deleted</span> <span class="o">=</span> <span class="kp">false</span>
<span class="n">audit</span> <span class="o">=</span> <span class="s1">'NONE'</span>

<span class="n">invoice_payment</span><span class="p">.</span><span class="nf">tags</span><span class="p">(</span><span class="n">included_deleted</span><span class="p">,</span>
                     <span class="n">audit</span><span class="p">,</span>
                     <span class="n">options</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="n">invoicePaymentApi</span> <span class="o">=</span> <span class="n">killbill</span><span class="p">.</span><span class="n">api</span><span class="p">.</span><span class="n">InvoicePaymentApi</span><span class="p">()</span>
<span class="n">payment_id</span> <span class="o">=</span> <span class="s">'2a1ffd2c-0de1-4f5c-b2a9-27d8deebe596'</span>

<span class="n">invoicePaymentApi</span><span class="p">.</span><span class="n">get_invoice_payment_tags</span><span class="p">(</span><span class="n">payment_id</span><span class="p">,</span> <span class="n">api_key</span><span class="p">,</span> <span class="n">api_secret</span><span class="p">)</span>
</code></pre></div>
<blockquote>
<p>Example Response:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"tagId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"e7f68cab-3b9a-4150-909a-5f1c17f1fb2b"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"objectType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"PAYMENT"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"objectId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cc7fcd4d-e701-4679-9741-41289103db83"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"tagDefinitionId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"353752dd-9041-4450-b782-a8bb03a923c8"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"tagDefinitionName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"foo"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"auditLogs"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div>
<p><strong>Query Parameters</strong></p>

<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Required</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>includedDeleted</strong></td>
<td>boolean</td>
<td>no</td>
<td>false</td>
<td>If true, include deleted tags</td>
</tr>
<tr>
<td><strong>audit</strong></td>
<td>string</td>
<td>no</td>
<td>&quot;NONE&quot;</td>
<td>Level of audit information to return</td>
</tr>
</tbody></table>

<p>Audit information options are &quot;NONE&quot;, &quot;MINIMAL&quot; (only inserts), or &quot;FULL&quot;.</p>

<p><strong>Response</strong></p>

<p>If successful, returns a status code of 200 and a list of tag objects.</p>
<h3 id='remove-tags-from-an-invoice-payment'>Remove tags from an invoice payment</h3>
<p>Removes a list of tags attached to an InvoicePayment.</p>

<p><strong>HTTP Request</strong> </p>

<p><code>DELETE http://127.0.0.1:8080/1.0/kb/invoicePayments/{paymentId}/tags</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="nt">-v</span> <span class="se">\</span>
    <span class="nt">-X</span> DELETE <span class="se">\</span>
    <span class="nt">-u</span> admin:password <span class="se">\</span>
    <span class="nt">-H</span> <span class="s1">'X-Killbill-ApiKey: bob'</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s1">'X-Killbill-ApiSecret: lazar'</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s1">'X-Killbill-CreatedBy: demo'</span> <span class="se">\</span>
    <span class="s1">'http://127.0.0.1:8080/1.0/kb/invoicePayments/cc7fcd4d-e701-4679-9741-41289103db83/tags?tagDef=00000000-0000-0000-0000-000000000001'</span>    
</code></pre></div><div class="highlight"><pre class="highlight java tab-java"><code><span class="kn">import</span> <span class="nn">org.killbill.billing.client.api.gen.InvoicePaymentApi</span><span class="o">;</span>
<span class="kd">protected</span> <span class="nc">InvoicePaymentApi</span> <span class="n">invoicePaymentApi</span><span class="o">;</span>

<span class="no">UUID</span> <span class="n">paymentId</span> <span class="o">=</span> <span class="no">UUID</span><span class="o">.</span><span class="na">fromString</span><span class="o">(</span><span class="s">"e659f0f3-745c-46d5-953c-28fe9282fc7d"</span><span class="o">);</span>

<span class="no">UUID</span> <span class="n">autoPayOffId</span> <span class="o">=</span> <span class="no">UUID</span><span class="o">.</span><span class="na">fromString</span><span class="o">(</span><span class="s">"00000000-0000-0000-0000-000000000001"</span><span class="o">);</span>

<span class="n">invoicePaymentApi</span><span class="o">.</span><span class="na">deleteInvoicePaymentTags</span><span class="o">(</span><span class="n">paymentId</span><span class="o">,</span> 
                                           <span class="nc">List</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="n">autoPayOffId</span><span class="o">),</span> 
                                           <span class="n">requestOptions</span><span class="o">);</span>
</code></pre></div><div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="n">tag_name</span> <span class="o">=</span> <span class="s1">'TEST'</span>

<span class="n">invoice_payment</span><span class="p">.</span><span class="nf">remove_tag</span><span class="p">(</span><span class="n">tag_name</span><span class="p">,</span>
                           <span class="n">user</span><span class="p">,</span>
                           <span class="n">reason</span><span class="p">,</span>
                           <span class="n">comment</span><span class="p">,</span>
                           <span class="n">options</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="n">invoicePaymentApi</span> <span class="o">=</span> <span class="n">killbill</span><span class="p">.</span><span class="n">api</span><span class="p">.</span><span class="n">InvoicePaymentApi</span><span class="p">()</span>
<span class="n">payment_id</span> <span class="o">=</span> <span class="s">'8d85a8e8-c94b-438f-aac1-e8cb436b2c05'</span>
<span class="n">tag</span> <span class="o">=</span> <span class="p">[</span><span class="s">"00000000-0000-0000-0000-000000000002"</span><span class="p">]</span>

<span class="n">invoicePaymentApi</span><span class="p">.</span><span class="n">delete_invoice_payment_tags</span><span class="p">(</span><span class="n">payment_id</span><span class="p">,</span> 
                                              <span class="n">created_by</span><span class="p">,</span> 
                                              <span class="n">api_key</span><span class="p">,</span> 
                                              <span class="n">api_secret</span><span class="p">,</span> 
                                              <span class="n">tag_def</span><span class="o">=</span><span class="n">tag</span><span class="p">)</span>
</code></pre></div>
<p><strong>Query Parameters</strong></p>

<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Required</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>tagDef</strong></td>
<td>array of string</td>
<td>yes</td>
<td>none</td>
<td>List of tag definition IDs identifying the tags that should be removed.</td>
</tr>
</tbody></table>

<p><strong>Response</strong></p>

<p>If successful, returns a status code of 204 and an empty body.</p>
<h2 id='audit-logs'>Audit Logs</h2>
<p>Audit logs provide a record of events that occur involving various specific resources. For details on audit logs see <a href="https://killbill.github.io/slate/#using-kill-bill-apis-audit-and-history">Audit and History</a>.</p>
<h3 id='retrieve-invoice-payment-audit-logs-with-history-by-id'>Retrieve invoice payment audit logs with history by id</h3>
<p>Retrieves a list of audit log records showing events that occurred involving changes to a specified invoice payment. History information is included with each record.</p>

<p><strong>HTTP Request</strong> </p>

<p><code>GET http://127.0.0.1:8080/1.0/kb/invoicePayments/{paymentId}/auditLogsWithHistory</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="se">\</span>
    <span class="nt">-u</span> admin:password <span class="se">\</span>
    <span class="nt">-H</span> <span class="s1">'X-Killbill-ApiKey: bob'</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s1">'X-Killbill-ApiSecret: lazar'</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s1">'Accept: application/json'</span> <span class="se">\</span>
    <span class="s1">'http://127.0.0.1:8080/1.0/kb/invoicePayments/8fe697d4-2c25-482c-aa45-f6cd5a48186d/auditLogsWithHistory'</span> 
</code></pre></div><div class="highlight"><pre class="highlight java tab-java"><code>                                                                                      <span class="n">requestOptions</span><span class="o">);</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code></code></pre></div><div class="highlight"><pre class="highlight ruby tab-ruby"><code></code></pre></div>
<blockquote>
<p>Example Response:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"changeType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"INSERT"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"changeDate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-07-19T16:39:00.000Z"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"objectType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"PAYMENT"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"objectId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"8fe697d4-2c25-482c-aa45-f6cd5a48186d"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"changedBy"</span><span class="p">:</span><span class="w"> </span><span class="s2">"demo"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"reasonCode"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"comments"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"userToken"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5d32d0ab-3c08-47b2-8c6d-bb9d2a7fd62c"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"history"</span><span class="p">:</span><span class="w"> 
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nl">"createdDate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-07-19T16:39:00.000Z"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"updatedDate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-07-19T16:39:00.000Z"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"recordId"</span><span class="p">:</span><span class="w"> </span><span class="mi">14</span><span class="p">,</span><span class="w">
      </span><span class="nl">"accountRecordId"</span><span class="p">:</span><span class="w"> </span><span class="mi">35</span><span class="p">,</span><span class="w">
      </span><span class="nl">"tenantRecordId"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nl">"accountId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"84c7e0d4-a5ed-405f-a655-3ed16ae19997"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"paymentNumber"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nl">"paymentMethodId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"916619a4-02bb-4d3d-b3da-2584ac897b19"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"externalKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"paymentExternalKey"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"stateName"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nl">"lastSuccessStateName"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nl">"tableName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"PAYMENTS"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"historyTableName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"PAYMENT_HISTORY"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
</span><span class="p">]</span><span class="w">

</span><span class="err">**Query</span><span class="w"> </span><span class="err">Parameters**</span><span class="w">

</span><span class="err">None.</span><span class="w">

</span><span class="err">**Response**</span><span class="w">

</span><span class="err">If</span><span class="w"> </span><span class="err">successful,</span><span class="w"> </span><span class="err">returns</span><span class="w"> </span><span class="err">a</span><span class="w"> </span><span class="err">status</span><span class="w"> </span><span class="err">code</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="mi">200</span><span class="w"> </span><span class="err">and</span><span class="w"> </span><span class="err">a</span><span class="w"> </span><span class="err">list</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">account</span><span class="w"> </span><span class="err">audit</span><span class="w"> </span><span class="err">logs</span><span class="w"> </span><span class="err">with</span><span class="w"> </span><span class="err">history.</span><span class="w">

</span></code></pre></div>
        </div>
        <div class="dark-box">
          <div id="docsearch"></div>
        </div>
      </div>
    </body>
    <script>
      setTimeout(function(){
        $('.content h2, .content h3, .content h4').append('<a href=""><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>');
        $('.content h2, .content h3, .content h4').each(function(){
          let itemHref = '#' + $(this).attr('id');
          $(this).find('a').attr("href", itemHref);
        });
      })

      function restructureDOM() {
        const toElem = (elems) => {
          const elem = document.createElement('div');
          elems.forEach((elm, i) => {
            const childElem = document.createElement('div');
            childElem.classList.add(`section-container`)

            const codeBlocks = document.createElement('div');
            codeBlocks.classList.add('code-block');
            const sectionContent = document.createElement('div');
            sectionContent.classList.add('section-content')

            elm.forEach((el, i) => {
              console.log(el)
              if(el.tagName.toLowerCase() === "blockquote" || el.className === "highlight") {
                codeBlocks.append(el);
              } else {
                sectionContent.append(el);
              }

              childElem.append(sectionContent);
              childElem.append(codeBlocks);
            });

            elem.appendChild(childElem);
            console.log(childElem);
          });
          return elem;
        }

        const content = $('.content').children();

        let oneSection = [];
        let allSections = [];
        let h2Occurence = 0;

        content.each((index, element) => {
          console.log(element.classList)
          if(h2Occurence !== 0 && (element.tagName === "H2" || element.id === "tenant")) {
            allSections.push(oneSection);
            oneSection = [];
          }
          oneSection.push(element);
          if(element.tagName === "H2") h2Occurence++;
        });

        const convertedNodes = toElem(allSections);
        console.log(convertedNodes, 'convertedNodes')
        $('.content').append(convertedNodes);
      }

      setTimeout(() => {
        restructureDOM();
      }, 1000);
    </script>
    <script src='https://cdn.jsdelivr.net/npm/@docsearch/js@3'></script>
    <script>
      docsearch({apiKey: '3ef227e7fd5e2e1a3fffd880484934bf', container: '#docsearch', appId: 'S2ISXITURI', indexName: 'killbill_slate'});
    </script>
  </html>
