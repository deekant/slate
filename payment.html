<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
      <title>Kill Bill</title>
      <style media="screen">
        .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .ch, .highlight .cd, .highlight .cpf {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s, .highlight .sa, .highlight .dl {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf, .highlight .fm {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv, .highlight .vm {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .nl {
  color: #f92672;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
      </style>
      <style media="print">
        * {
          -webkit-transition:none!important;
          transition:none!important;
        }
        .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight, .highlight .w {
  color: #586e75;
}
.highlight .err {
  color: #002b36;
  background-color: #dc322f;
}
.highlight .c, .highlight .ch, .highlight .cd, .highlight .cm, .highlight .cpf, .highlight .c1, .highlight .cs {
  color: #657b83;
}
.highlight .cp {
  color: #b58900;
}
.highlight .nt {
  color: #b58900;
}
.highlight .o, .highlight .ow {
  color: #93a1a1;
}
.highlight .p, .highlight .pi {
  color: #93a1a1;
}
.highlight .gi {
  color: #859900;
}
.highlight .gd {
  color: #dc322f;
}
.highlight .gh {
  color: #268bd2;
  background-color: #002b36;
  font-weight: bold;
}
.highlight .k, .highlight .kn, .highlight .kp, .highlight .kr, .highlight .kv {
  color: #6c71c4;
}
.highlight .kc {
  color: #cb4b16;
}
.highlight .kt {
  color: #cb4b16;
}
.highlight .kd {
  color: #cb4b16;
}
.highlight .s, .highlight .sb, .highlight .sc, .highlight .dl, .highlight .sd, .highlight .s2, .highlight .sh, .highlight .sx, .highlight .s1 {
  color: #859900;
}
.highlight .sa {
  color: #6c71c4;
}
.highlight .sr {
  color: #2aa198;
}
.highlight .si {
  color: #d33682;
}
.highlight .se {
  color: #d33682;
}
.highlight .nn {
  color: #b58900;
}
.highlight .nc {
  color: #b58900;
}
.highlight .no {
  color: #b58900;
}
.highlight .na {
  color: #268bd2;
}
.highlight .m, .highlight .mb, .highlight .mf, .highlight .mh, .highlight .mi, .highlight .il, .highlight .mo, .highlight .mx {
  color: #859900;
}
.highlight .ss {
  color: #859900;
}
      </style>
      <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
      <link href="stylesheets/print.css" rel="stylesheet" media="print" />
        <script src="javascripts/all.js"></script>
        <script>
          $(function() { setupCodeCopy(); });
        </script>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@3" />
    </head>
    <body class="payment" data-languages="[&quot;shell&quot;,&quot;java&quot;,&quot;ruby&quot;,&quot;python&quot;]">
      <header class="header sticky" id="header">
        <div class="header-wrapper">
          <div class="header-logo">
          <div class="logo-switch-wrapper">
              <div class="logo">
              <a href="/">
                <img src="images/logo/light-logo.svg" style="height:38px" alt="Kill Bill Docs" id="logo">
              </a>
            </div>
            <div class="switch">
              <input type="checkbox" id="theme-toggle">
              <span class="slider round"></span>
            </div>
          </div>
            <div class="header-search">
              <div class="search-form-wrapper">
                <div id="docsearch" style="height: 43px; display: flex; align-items: center; width: 100%;">
                </div>
              </div>
            </div>
          </div>
          <div class="nav-toggler sidebar-toggler">
            <svg class="hamburger" xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 24 24" fill="none">
              <path fill-rule="evenodd" clip-rule="evenodd" d="M20.75 7C20.75 7.41421 20.4142 7.75 20 7.75L4 7.75C3.58579 7.75 3.25 7.41421 3.25 7C3.25 6.58579 3.58579 6.25 4 6.25L20 6.25C20.4142 6.25 20.75 6.58579 20.75 7Z" fill=""/>
              <path fill-rule="evenodd" clip-rule="evenodd" d="M20.75 12C20.75 12.4142 20.4142 12.75 20 12.75L4 12.75C3.58579 12.75 3.25 12.4142 3.25 12C3.25 11.5858 3.58579 11.25 4 11.25L20 11.25C20.4142 11.25 20.75 11.5858 20.75 12Z" fill=""/>
              <path fill-rule="evenodd" clip-rule="evenodd" d="M20.75 17C20.75 17.4142 20.4142 17.75 20 17.75L4 17.75C3.58579 17.75 3.25 17.4142 3.25 17C3.25 16.5858 3.58579 16.25 4 16.25L20 16.25C20.4142 16.25 20.75 16.5858 20.75 17Z" fill=""/>
            </svg>
          </div>
            <div class="lang-selector">
                  <a href="#" data-language-name="shell">shell</a>
                  <a href="#" data-language-name="java">java</a>
                  <a href="#" data-language-name="ruby">ruby</a>
                  <a href="#" data-language-name="python">python</a>
            </div>
        </div>
      </header>
      <div class="loader-wrapper">
        <div id="loading"></div>
      </div>
      <script>
        $(window).on('load',function(){
          $('.loader-wrapper').hide();
        });
      </script>
      <a href="#" id="nav-button">
        <span>
          NAV
          <img src="images/navbar.png" alt="" />
        </span>
      </a>
      <div class="toc-wrapper">
          <div class="lang-selector">
                <a href="#" data-language-name="shell">shell</a>
                <a href="#" data-language-name="java">java</a>
                <a href="#" data-language-name="ruby">ruby</a>
                <a href="#" data-language-name="python">python</a>
          </div>
        <ul id="toc" class="toc-list-h1">
            <li>
                <a href="#payment" class="toc-h1 toc-link" data-title="Payment">Payment</a>
                <ul class="toc-list-h2">
                    <li>
                      <a href="#payment-resource" class="toc-h2 toc-link" data-title="Payment Resource">Payment Resource</a>
                    </li>
                    <li>
                      <a href="#payments" class="toc-h2 toc-link" data-title="Payments">Payments</a>
                    </li>
                    <li>
                      <a href="#custom-fields" class="toc-h2 toc-link" data-title="Custom Fields">Custom Fields</a>
                    </li>
                    <li>
                      <a href="#tags" class="toc-h2 toc-link" data-title="Tags">Tags</a>
                    </li>
                    <li>
                      <a href="#audit-logs" class="toc-h2 toc-link" data-title="Audit Logs">Audit Logs</a>
                    </li>
                    <li>
                      <a href="#list-and-search" class="toc-h2 toc-link" data-title="List and Search">List and Search</a>
                    </li>
                </ul>
            </li>
        </ul>
          <ul class="toc-footer">
              <li><a href="mailto:support@killbill.io">Report a doc problem </a></li>
          </ul>
      </div>
      <div class="page-wrapper">
        <div class="content">
          <h1 id='payment'>Payment</h1>
<p>A Payment in Kill Bill is an amount paid or payable on a specific account due to an invoice or independent of any invoice.</p>

<p>A Payment may be associated with a series of <code>PaymentTransaction</code>s, such as authorization, payment attempt, chargeback, etc. each of which may succeed or fail.</p>

<p>A Payment Transaction takes place using a <code>PaymentMethod</code> such as a credit card. The transaction is processed by a plugin, which provides access to the appropriate payment gateway. The payment gateway processes the transaction, using the Payment Method provided in the request.</p>

<p>A Payment Attempt is an attempt to perform a Payment Transaction. A Payment Attempt may succeed or fail, and a Payment Transaction may have more than one Payment Attempt. In some cases a Payment Transaction may be in a PENDING state waiting for completion of its processing by the plugin.</p>

<p>Please refer to the <a href="http://docs.killbill.io/latest/userguide_payment.html">payment manual</a> for more details.</p>
<h2 id='payment-resource'>Payment Resource</h2>
<p>A Payment is represented by a <code>Payment</code> resource object. The attributes for the Payment resource are as follows:</p>

<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Generated by</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>paymentId</strong></td>
<td>string</td>
<td>system</td>
<td>UUID for the payment</td>
</tr>
<tr>
<td><strong>accountId</strong></td>
<td>string</td>
<td>system</td>
<td>UUID for the account</td>
</tr>
<tr>
<td><strong>paymentNumber</strong></td>
<td>number</td>
<td>user or system</td>
<td>User&#39;s ID number for the payment</td>
</tr>
<tr>
<td><strong>paymentExternalKey</strong></td>
<td>string</td>
<td>user or system</td>
<td>Optional external key</td>
</tr>
<tr>
<td><strong>authAmount</strong></td>
<td>string</td>
<td>system</td>
<td>Total amount authorized (see below)</td>
</tr>
<tr>
<td><strong>capturedAmount</strong></td>
<td>string</td>
<td>system</td>
<td>Total amount captured (see below)</td>
</tr>
<tr>
<td><strong>purchasedAmount</strong></td>
<td>string</td>
<td>system</td>
<td>Total amount purchased (see below)</td>
</tr>
<tr>
<td><strong>refundedAmount</strong></td>
<td>string</td>
<td>system</td>
<td>Total amount refunded (see below)</td>
</tr>
<tr>
<td><strong>creditedAmount</strong></td>
<td>string</td>
<td>system</td>
<td>Total amount credited (see below)</td>
</tr>
<tr>
<td><strong>currency</strong></td>
<td>string</td>
<td>user or system</td>
<td>Currency associated with the account</td>
</tr>
<tr>
<td><strong>paymentMethodId</strong></td>
<td>string</td>
<td>system</td>
<td>UUID for the payment method</td>
</tr>
<tr>
<td><strong>transactions</strong></td>
<td>list</td>
<td>system</td>
<td><strong>PaymentTransactions</strong> associated with this payment (see below)</td>
</tr>
<tr>
<td><strong>paymentAttempts</strong></td>
<td>list</td>
<td>system</td>
<td>Payment retries (see below)</td>
</tr>
</tbody></table>

<ul>
<li><p><strong>authAmount</strong>: Total amount that is authorized for this payment. Often this is the amount authorized by a single AUTHORIZATION Payment Transaction.</p></li>
<li><p><strong>capturedAmount</strong>: Total amount that has been captured (that is, successfully paid).</p></li>
<li><p><strong>purchasedAmount</strong>: Total amount that has been purchased. A PURCHASE transaction combines authorization and capture.</p></li>
<li><p><strong>refundedAmount</strong>: Total amount that has been refunded.</p></li>
<li><p><strong>creditedAmount</strong>: Total amount that has been credited.</p></li>
<li><p><strong>paymentAttempts</strong>: Number of payment attempts; this is only effective when the system has been configured to retry failed transactions.</p></li>
</ul>

<p>The attributes for a <code>PaymentTransaction</code> are described <a href="payment-transaction.html#payment-transaction-payments-transactions">here</a>.</p>
<h2 id='payments'>Payments</h2>
<p>These endpoints initiate transactions on an existing Payment. To begin a new Payment, see <a href="account.html#account-trigger-a-payment-authorization-purchase-or-credit">Trigger a Payment</a> in the Account API. </p>
<h3 id='capture-an-existing-authorization-using-paymentid'>Capture an existing authorization [using paymentId]</h3>
<p>Attempts to capture a payment amount based on a prior authorization. (A prior authorization may be created via the <a href="account.html#account-trigger-a-payment-authorization-purchase-or-credit">Trigger a Payment</a> endpoint). The Payment is identified by its <code>paymentId</code> provided as a path parameter.</p>

<p><strong>HTTP Request</strong> </p>

<p><code>POST http://127.0.0.1:8080/1.0/kb/payments/{paymentId}</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>

<p><strong>Request Body</strong></p>

<p>A <code>PaymentTransaction</code> object containing, as a minimum, the <code>amount</code> to be captured.</p>

<p><strong>Query Parameters</strong></p>

<p>None.</p>

<p><strong>Response</strong></p>

<p>If successful, returns a status code of 201 and an empty body. A Location header containing the payment id is also included in the response. A PaymentTransaction of type CAPTURE is created.</p>
<h3 id='capture-an-existing-authorization-using-paymentexternalkey'>Capture an existing authorization [using paymentExternalKey]</h3>
<p>Requests a payment amount based on a prior authorization.(A prior authorization may be created via the <a href="account.html#account-trigger-a-payment-authorization-purchase-or-credit">Trigger a Payment</a> endpoint).The payment is identified by its external key given in the request body.</p>

<p><strong>HTTP Request</strong> </p>

<p><code>POST http://127.0.0.1:8080/1.0/kb/payments</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>

<p><strong>Request Body</strong></p>

<p>A <code>PaymentTransaction</code> object containing, as a minimum, the <code>paymentExternalKey</code> and the<code>amount</code> to be captured.</p>

<p><strong>Query Parameters</strong></p>

<p>None.</p>

<p><strong>Response</strong></p>

<p>If successful, returns a status code of 201 and an empty body. A Location header containing the payment id is also included in the response. A PaymentTransaction of type CAPTURE is created.</p>
<h3 id='retrieve-a-payment-using-paymentid'>Retrieve a payment [using paymentId]</h3>
<p>Retrieves a <code>Payment</code> object based on its <code>paymentId</code> given as a path parameter.</p>

<p><strong>HTTP Request</strong> </p>

<p><code>GET http://127.0.0.1:8080/1.0/kb/payments/{paymentId}</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>

<blockquote>
<p>Example Response:</p>
</blockquote>

<p><strong>Query Parameters</strong></p>

<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Required</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>withPluginInfo</strong></td>
<td>boolean</td>
<td>no</td>
<td>false</td>
<td>If true, include plugin info</td>
</tr>
<tr>
<td><strong>withAttempts</strong></td>
<td>boolean</td>
<td>no</td>
<td>false</td>
<td>If true, include payment attempts</td>
</tr>
<tr>
<td><strong>audit</strong></td>
<td>string</td>
<td>no</td>
<td>&quot;NONE&quot;</td>
<td>Level of audit information to return</td>
</tr>
</tbody></table>

<p>Audit information options are &quot;NONE&quot;, &quot;MINIMAL&quot; (only inserts), or &quot;FULL&quot;.</p>

<p><strong>Response</strong></p>

<p>If successful, returns a status code of 200 and a <code>Payment</code> object.</p>

<p><strong>Note:</strong> The <code>effectiveDate</code> of the last payment attempt in <code>SCHEDULED</code> state corresponds to the next scheduled payment retry date and can be used as such.</p>
<h3 id='retrieve-a-payment-using-paymentexternalkey'>Retrieve a payment [using paymentExternalKey]</h3>
<p>Retrieves a Payment object based on its external key given as a query parameter.</p>

<p><strong>HTTP Request</strong> </p>

<p><code>GET http://127.0.0.1:8080/1.0/kb/payments</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>

<blockquote>
<p>Example Response:</p>
</blockquote>

<p><strong>Query Parameters</strong></p>

<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Required</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>externalKey</strong></td>
<td>string</td>
<td>yes</td>
<td>none</td>
<td>Payment external key</td>
</tr>
<tr>
<td><strong>withPluginInfo</strong></td>
<td>boolean</td>
<td>no</td>
<td>false</td>
<td>If true, include plugin info</td>
</tr>
<tr>
<td><strong>withAttempts</strong></td>
<td>boolean</td>
<td>no</td>
<td>false</td>
<td>If true, include payment attempts</td>
</tr>
<tr>
<td><strong>audit</strong></td>
<td>string</td>
<td>no</td>
<td>&quot;NONE&quot;</td>
<td>Level of audit information to return</td>
</tr>
</tbody></table>

<p>Audit information options are &quot;NONE&quot;, &quot;MINIMAL&quot; (only inserts), or &quot;FULL&quot;.</p>

<p><strong>Response</strong></p>

<p>If successful, returns a status code of 200 and a <code>Payment</code> object.</p>
<h3 id='complete-an-existing-transaction-using-paymentid'>Complete an existing transaction [using paymentId]</h3>
<p>Completes any existing PaymentTransaction that is in a PENDING state, based on its <code>paymentId</code> given as a path parameter.</p>

<p><strong>HTTP Request</strong> </p>

<p><code>PUT http://127.0.0.1:8080/1.0/kb/payments/{paymentId}</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>

<p><strong>Request Body</strong></p>

<p>A PaymentTransaction object containing, at least, the <code>paymentId</code></p>

<p><strong>Query Parameters</strong></p>

<p>None.</p>

<p><strong>Returns</strong></p>

<p>If successful, returns a status code of 204 and an empty body.</p>
<h3 id='complete-an-existing-transaction-using-paymentexternalkey'>Complete an existing transaction [using paymentExternalKey]</h3>
<p>Completes any existing PaymentTransaction that is in a PENDING state, based on its <code>paymentExternalKey</code> given in the request body.</p>

<p><strong>HTTP Request</strong> </p>

<p><code>PUT http://127.0.0.1:8080/1.0/kb/payments</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>

<p><strong>Request Body</strong></p>

<p>A PaymentTransaction object containing, at least, the <code>paymentExternalKey</code></p>

<p><strong>Query Parameters</strong></p>

<p>None.</p>

<p><strong>Returns</strong></p>

<p>If successful, returns a status code of 204 and an empty body.</p>
<h3 id='void-an-existing-payment-using-paymentid'>Void an existing payment [using paymentId]</h3>
<p>Voids a Payment, providing it is in a voidable state. For example, a Payment with only an AUTHORIZE transaction can be voided. No further transactions are possible on a voided Payment. The Payment is identified by its <code>paymentId</code>, which is given as a path parameter.</p>

<p><strong>HTTP Request</strong> </p>

<p><code>DELETE http://127.0.0.1:8080/1.0/kb/payments/{paymentId}</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>

<p><strong>Request Body</strong></p>

<p>A PaymentTransaction object containing, at least, the <code>paymentId</code></p>

<p><strong>Query Parameters</strong></p>

<p>None.</p>

<p><strong>Returns</strong></p>

<p>If successful, returns a status code of 204 and an empty body. a PaymentTransaction of type VOID is created.</p>
<h3 id='void-an-existing-payment-using-paymentexternalkey'>Void an existing payment [using paymentExternalKey]</h3>
<p>Voids a Payment, providing it is in a voidable state. For example, a Payment with only an AUTHORIZE transaction can be voided. can be voided. No further transactions are possible on a voided payment. The payment is identified by its <code>paymentExternalKey</code>, which is given as a query parameter.</p>

<p><strong>HTTP Request</strong> </p>

<p><code>DELETE http://127.0.0.1:8080/1.0/kb/payments</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>

<p><strong>Request Body</strong></p>

<p>A Payment object containing, at least, the <code>paymentExternalKey</code>.</p>

<p><strong>Query Parameters</strong></p>

<p>None.</p>

<p><strong>Returns</strong></p>

<p>If successful, returns a status code of 204 and an empty body. A PaymentTransaction of type VOID is created.</p>
<h3 id='record-a-chargeback-using-paymentid'>Record a chargeback [using paymentId]</h3>
<p>Creates a CHARGEBACK PaymentTransaction for a specified Payment. The Payment is identified by its <code>paymentId</code> given as a path parameter. The captured amount is reduced by the chargeback amount.</p>

<p><strong>HTTP Request</strong> </p>

<p><code>POST http://127.0.0.1:8080/1.0/kb/payments/{paymentId}/chargebacks</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>

<p><strong>Request Body</strong></p>

<p>A Payment Transaction object containing, at least, the <code>amount</code>.</p>

<p><strong>Query Parameters</strong></p>

<p>None.</p>

<p><strong>Returns</strong></p>

<p>If successful, returns a status code of 204 and an empty body. A Payment Transaction is created with type CHARGEBACK.</p>
<h3 id='record-a-chargeback-using-paymentexternalkey'>Record a chargeback [using paymentExternalKey]</h3>
<p>Creates a CHARGEBACK PaymentTransaction for a specified Payment. The Payment is identified by its <code>paymentExternalKey</code> given in the request body. The captured amount is reduced by the chargeback amount.</p>

<p><strong>HTTP Request</strong> </p>

<p><code>POST http://127.0.0.1:8080/1.0/kb/payments/chargebacks</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>

<p><strong>Request Body</strong></p>

<p>A PaymentTransaction object containing, at least, the <code>paymentExternalKey</code> and the <code>amount</code>.</p>

<p><strong>Query Parameters</strong></p>

<p>None.</p>

<p><strong>Returns</strong></p>

<p>If successful, returns a status code of 204 and an empty body. A PaymentTransaction is created with type CHARGEBACK.</p>
<h3 id='record-a-chargeback-reversal-using-paymentid'>Record a chargeback reversal [using paymentId]</h3>
<p>Reverses a CHARGEBACK PaymentTransaction, if permitted by the Payment plugin. The chargeback amount is added back to the captured amount. The payment is identified by its <code>paymentId</code> which is given as a path parameter. The CHARGEBACK transaction is identified by its <code>transactionExternalKey</code> which is given in the request body.</p>

<p><strong>HTTP Request</strong> </p>

<p><code>POST http://127.0.0.1:8080/1.0/kb/payments/{paymentId}/chargebackReversals</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>

<p><strong>Request Body</strong></p>

<p>A PaymentTransaction object containing, at least, the <code>transactionExternalKey</code>.</p>

<p><strong>Query Parameters</strong></p>

<p>None.</p>

<p><strong>Response</strong></p>

<p>If successful, returns a status code of 201 and an empty body.</p>
<h3 id='record-a-chargeback-reversal-using-paymentexternalkey'>Record a chargeback reversal [using paymentExternalKey]</h3>
<p>Reverses a CHARGEBACK PaymentTransaction, if permitted by the Payment plugin. The chargeback amount is added back to the captured amount. The Payment is identified by its <code>paymentExternalKey</code> which is given in the request body. The CHARGEBACK transaction is identified by its <code>transactionExternalKey</code> which is also given in the request body.</p>

<p><strong>HTTP Request</strong> </p>

<p><code>POST http://127.0.0.1:8080/1.0/kb/payments/chargebackReversals</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>

<p><strong>Request Body</strong></p>

<p>A PaymentTransaction object containing, at least, the <code>paymentExternalKey</code> and the <code>TransactionExternalKey</code>.</p>

<p><strong>Query Parameters</strong></p>

<p>None.</p>

<p><strong>Response</strong></p>

<p>If successful, returns a status code of 201 and an empty body.</p>
<h3 id='refund-an-existing-payment-using-paymentid'>Refund an existing payment [using paymentId]</h3>
<p>Refunds part or all of the balance of an existing Payment. The Payment is identified by its <code>paymentId</code>, which is given as a path parameter. </p>

<p><strong>HTTP Request</strong> </p>

<p><code>POST http://127.0.0.1:8080/1.0/kb/payments/{paymentId}/refunds</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>

<p><strong>Request Body</strong></p>

<p>A PaymentTransaction object including, as a minimum, the <code>amount</code> to be refunded.</p>

<p><strong>Query Parameters</strong></p>

<p>None. </p>

<p><strong>Returns</strong></p>

<p>If successful, returns a status code of 201 and an empty body. In addition, a Location header containing the payment id is returned. A new PaymentTransaction of type <code>REFUND</code> is created.</p>
<h3 id='refund-an-existing-payment-using-paymentexternalkey'>Refund an existing payment [using paymentExternalKey]</h3>
<p>Refunds part or all of the balance of an existing payment. The payment is identified by its <code>paymentExternalKey</code>, which is given in the request body.</p>

<p><strong>HTTP Request</strong> </p>

<p><code>POST http://127.0.0.1:8080/1.0/kb/payments/refunds</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>

<p><strong>Request Body</strong></p>

<p>A PaymentTransaction object including, as a minimum, the <code>paymentExternalKey</code> and the <code>amount</code> to be refunded.</p>

<p><strong>Query Parameters</strong></p>

<p>None. </p>

<p><strong>Returns</strong></p>

<p>If successful, returns a status code of 201 and an empty body. In addition, a Location header containing the payment id is returned. A new PaymentTransaction of type <code>REFUND</code> is created.</p>
<h3 id='cancel-a-scheduled-payment-attempt-retry-using-transactionid'>Cancel a scheduled payment attempt retry [using transactionId]</h3>
<p>Cancels a scheduled attempt to retry a PaymentTransaction. The transaction is identified by its <code>transactionId</code>, which is provided as a path parameter.</p>

<p><strong>HTTP Request</strong> </p>

<p><code>DELETE http://127.0.0.1:8080/1.0/kb/payments/{paymentTransactionId}/cancelScheduledPaymentTransaction</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>

<p><strong>Query Parameters</strong></p>

<p>None.</p>

<p><strong>Response</strong></p>

<p>If successful, returns a status code of 204 and an empty body.</p>
<h3 id='cancel-a-scheduled-payment-attempt-retry-using-transactionexternalkey'>Cancel a scheduled payment attempt retry [using transactionExternalKey]</h3>
<p>Cancels a scheduled attempt to retry a PaymentTransaction. The transaction is identified by its <code>transactionExternalKey</code>, which is provided as a query parameter.</p>

<p><strong>HTTP Request</strong> </p>

<p><code>DELETE http://127.0.0.1:8080/1.0/kb/payments/cancelScheduledPaymentTransaction</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>

<p><strong>Query Parameters</strong></p>

<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Required</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>transactionExternalKey</strong></td>
<td>string</td>
<td>yes</td>
<td>none</td>
<td>Transaction external key</td>
</tr>
</tbody></table>

<p><strong>Response</strong></p>

<p>If successful, returns a status code of 204 and an empty body.</p>
<h3 id='combo-api-to-create-a-new-payment-transaction-on-a-existing-or-not-account'>Combo api to create a new payment transaction on a existing (or not) account</h3>
<p>This API creates a PaymentTransaction of type AUTHORIZE, PURCHASE, or CREDIT. This is the same as the API <a href="account.html#account-trigger-a-payment-authorization-purchase-or-credit">Trigger a Payment</a> described with the Account endpoints. However, this API can optionally create a new Account and register a new PaymentMethod at the same time.</p>

<p><strong>HTTP Request</strong> </p>

<p><code>POST http://127.0.0.1:8080/1.0/kb/payments/combo</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>

<p><strong>Request Body</strong></p>

<p>The request body is a JSON string that represents three distinct objects: account, paymentMethod, and transaction. For example:</p>

<p>This example assumes that a new Account is to be created.</p>

<ol>
<li><p>No attributes are required for the account; however if the <code>currency</code> attribute is not given here it must be given for the transaction.</p></li>
<li><p>If a new account is created, a new paymentMethod must be registered for that account.  The only attribute required here is the pluginName.</p></li>
<li><p>The transaction object contains, as a minimum, the transaction type, the amount, and the currency, unless given with the account.</p></li>
</ol>

<p><strong>Query Parameters</strong></p>

<p>None. </p>

<p><strong>Returns</strong></p>

<p>If successful, returns a status code of 201 and an empty body. In addition, a <code>Location</code> header containing the <code>paymentId</code> is returned.</p>
<h2 id='custom-fields'>Custom Fields</h2>
<p>Custom fields are <code>{key, value}</code> attributes that can be attached to any customer resource. In particular they can be added to Payment objects. For details on Custom Fields see <a href="custom-field.html#custom-field">Custom Field</a>.</p>
<h3 id='add-custom-fields-to-payment'>Add custom fields to payment</h3>
<p>Adds one or more custom fields to a payment object. Existing custom fields are not modified.</p>

<p><strong>HTTP Request</strong> </p>

<p><code>POST http://127.0.0.1:8080/1.0/kb/payments/{paymentId}/customFields</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>

<p><strong>Request Body</strong></p>

<p>A list of <a href="custom-field.html#custom-field-custom-field-resource">Custom Field</a> objects. Each object should specify at least the the <code>name</code> and <code>value</code> attribute. For example:</p>

<p>[ { &quot;name&quot;: &quot;CF1&quot;, &quot;value&quot;: &quot;123&quot; } ]</p>

<p><strong>Query Parameters</strong></p>

<p>None.</p>

<p><strong>Response</strong></p>

<p>If successful, returns a 201 status code. In addition, a Location header is returned with the URL to retrieve the custom fields associated with the payment.</p>
<h3 id='retrieve-payment-custom-fields'>Retrieve payment custom fields</h3>
<p>Retrieves the custom fields associated with a payment</p>

<p><strong>HTTP Request</strong> </p>

<p><code>GET http://127.0.0.1:8080/1.0/kb/payments/{paymentId}/customFields</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>

<blockquote>
<p>Example Response:</p>
</blockquote>

<p><strong>Query Parameters</strong></p>

<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Required</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>audit</strong></td>
<td>string</td>
<td>no</td>
<td>&quot;NONE&quot;</td>
<td>Level of audit information to return:&quot;NONE&quot;, &quot;MINIMAL&quot;, or &quot;FULL&quot;</td>
</tr>
</tbody></table>

<p><strong>Response</strong></p>

<p>If successful, returns a status code of 200 and a (possibly empty) list of custom field objects.</p>
<h3 id='modify-custom-fields-for-a-payment'>Modify custom fields for a payment</h3>
<p>Modifies the custom fields associated with a payment object</p>

<p><strong>HTTP Request</strong> </p>

<p><code>PUT http://127.0.0.1:8080/1.0/kb/payments/{paymentId}/customFields</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>

<p><strong>Requst Body</strong></p>

<p>A list of <a href="custom-field.html#custom-field-custom-field-resource">Custom Field</a> objects representing the fields to substitute for existing ones. Each object should specify at least the the <code>customFieldId</code> and <code>value</code> attribute. For example:</p>

<p>[ { &quot;customFieldId&quot;: &quot;6d4c073b-fd89-4e39-9802-eba65f42492f&quot;, &quot;value&quot;: &quot;123&quot; } ]</p>

<p><strong>Query Parameters</strong></p>

<p>None.</p>

<p><strong>Response</strong></p>

<p>If successful, returns a status code of 204 and an empty body.</p>
<h3 id='remove-custom-fields-from-a-payment'>Remove custom fields from a payment</h3>
<p>Removes a specified set of custom fields from a payment object</p>

<p><strong>HTTP Request</strong> </p>

<p><code>DELETE http://127.0.0.1:8080/1.0/kb/payments/{paymentId}/customFields</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>

<p><strong>Query Parameters</strong></p>

<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Required</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>customField</strong></td>
<td>string</td>
<td>yes</td>
<td>none</td>
<td>CCustom field object ID that should be deleted. Multiple custom fields can be deleted by specifying a separate <strong>customField</strong> parameter corresponding to each field</td>
</tr>
</tbody></table>

<p><strong>Response</strong></p>

<p>If successful, returns a status code of 204 and an empty body.</p>
<h2 id='tags'>Tags</h2>
<p>See <a href="account.html#account-tags">Account Tags</a> for an introduction.</p>

<p>The are no <code>system</code> tags applicable to a Payment.</p>
<h3 id='add-tags-to-a-payment'>Add tags to a payment</h3>
<p>Adds one or more tags to a payment object. The tag definitions must already exist.</p>

<p><strong>HTTP Request</strong> </p>

<p><code>POST http://127.0.0.1:8080/1.0/kb/payments/{paymentId}/tags</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>

<p><strong>Request Body</strong></p>

<p>A JSON array containing one or more tag definition ids to be added as tags.</p>

<p><strong>Query Parameters</strong></p>

<p>None.</p>

<p><strong>Response</strong></p>

<p>If successful, returns a 201 status code. In addition, a Location header is returned containing the URL to retrieve the tags associated with the payment.</p>
<h3 id='retrieve-payment-tags'>Retrieve payment tags</h3>
<p>Retrieves all tags attached to this payment.</p>

<p><strong>HTTP Request</strong> </p>

<p><code>GET http://127.0.0.1:8080/1.0/kb/payments/{paymentId}/tags</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>

<blockquote>
<p>Example Response:</p>
</blockquote>

<p><strong>Query Parameters</strong></p>

<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Required</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>includedDeleted</strong></td>
<td>boolean</td>
<td>no</td>
<td>false</td>
<td>If true, include deleted tags</td>
</tr>
<tr>
<td><strong>audit</strong></td>
<td>string</td>
<td>no</td>
<td>&quot;NONE&quot;</td>
<td>Level of audit information to return: &quot;NONE&quot;, &quot;MINIMAL&quot;, or &quot;FULL&quot;</td>
</tr>
</tbody></table>

<p><strong>Response</strong></p>

<p>If successful, returns a status code of 200 and a list of tag objects.</p>
<h3 id='remove-tags-from-a-payment'>Remove tags from a payment</h3>
<p>Removes a list of tags attached to a payment.</p>

<p><strong>HTTP Request</strong> </p>

<p><code>DELETE http://127.0.0.1:8080/1.0/kb/payments/{paymentId}/tags</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>

<p><strong>Query Parameters</strong></p>

<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Required</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>tagDef</strong></td>
<td>array of string</td>
<td>yes</td>
<td>none</td>
<td>A tag definition ID identifying the tag that should be removed. Multiple tags can be deleted by specifying a separate tagDef parameter corresponding to each tag.</td>
</tr>
</tbody></table>

<p><strong>Response</strong></p>

<p>If successful, returns a status code of 204 and an empty body.</p>
<h2 id='audit-logs'>Audit Logs</h2>
<p>Audit logs provide a record of events that occur involving various specific resources. For details on audit logs see <a href="https://killbill.github.io/slate/#using-kill-bill-apis-audit-and-history">Audit and History</a>.</p>
<h3 id='retrieve-payment-audit-logs-with-history-by-id'>Retrieve payment audit logs with history by id</h3>
<p>Retrieves a list of audit log records showing events that occurred involving changes to a specified payment. History information is included with each record.</p>

<p><strong>HTTP Request</strong> </p>

<p><code>GET http://127.0.0.1:8080/1.0/kb/payments/{paymentId}/auditLogsWithHistory</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>

<blockquote>
<p>Example Response:</p>
</blockquote>

<p><strong>Query Parameters</strong></p>

<p>None.</p>

<p><strong>Response</strong></p>

<p>If successful, returns a status code of 200 and a list of payment audit logs with history.</p>
<h3 id='retrieve-payment-attempt-audit-logs-with-history-by-id'>Retrieve payment attempt audit logs with history by id</h3>
<p>Retrieves a list of audit log records showing events that occurred related to a specified payment attempt. History information is included with each record.</p>

<p><strong>HTTP Request</strong></p>

<p><code>GET http://127.0.0.1:8080/1.0/kb/payments/attempts/{payment_attempt_id}/auditLogsWithHistory</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>

<blockquote>
<p>Example Response:</p>
</blockquote>

<p><strong>Query Parameters</strong></p>

<p>None.</p>

<p><strong>Response</strong></p>

<p>If successful, returns a status code of 200 and a list of payment attempt audit logs with history.</p>
<h2 id='list-and-search'>List and Search</h2>
<p>These endpoints allow you to list all payments or to search for a specific payment.</p>
<h3 id='get-payments'>Get payments</h3>
<p>Retrieve a list of all payments for this tenant.</p>

<p><strong>HTTP Request</strong> </p>

<p><code>GET http://127.0.0.1:8080/1.0/kb/payments/pagination</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>

<blockquote>
<p>Example Response:</p>
</blockquote>

<p><strong>Query Parameters</strong></p>

<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Required</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>offset</strong></td>
<td>long</td>
<td>no</td>
<td>0</td>
<td>Starting index for items listed</td>
</tr>
<tr>
<td><strong>limit</strong></td>
<td>long</td>
<td>no</td>
<td>100</td>
<td>Maximum number of items to be listed</td>
</tr>
<tr>
<td><strong>withPluginInfo</strong></td>
<td>boolean</td>
<td>no</td>
<td>false</td>
<td>if true, include plugin info</td>
</tr>
<tr>
<td><strong>withAttempts</strong></td>
<td>boolean</td>
<td>no</td>
<td>false</td>
<td>if true, include payment attempts</td>
</tr>
<tr>
<td><strong>audit</strong></td>
<td>string</td>
<td>no</td>
<td>&quot;NONE&quot;</td>
<td>Level of audit information to return: &quot;NONE&quot;, &quot;MINIMAL&quot; (only inserts), or &quot;FULL&quot;</td>
</tr>
</tbody></table>

<p><strong>Response</strong></p>

<p>If successful, returns a status code of 200 and a list of all payments for this tenant.</p>
<h3 id='search-payments'>Search payments</h3>
<p>Search for a payment by a specified search string. The search string is compared against the <code>paymentNumber</code>, <code>paymentId</code>, <code>accountId</code>, or <code>transactionType</code> attributes. An exact match is required. </p>

<p><strong>HTTP Request</strong> </p>

<p><code>GET http://127.0.0.1:8080/1.0/kb/payments/search/{searchKey}</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>

<blockquote>
<p>Example Response:</p>
</blockquote>

<p><strong>Query Parameters</strong></p>

<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Required</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>searchKey</strong></td>
<td>string</td>
<td>yes</td>
<td>none</td>
<td>What you want to find</td>
</tr>
<tr>
<td><strong>offset</strong></td>
<td>long</td>
<td>no</td>
<td>0</td>
<td>Starting index for items listed</td>
</tr>
<tr>
<td><strong>limit</strong></td>
<td>long</td>
<td>no</td>
<td>100</td>
<td>Maximum number of items to be listed</td>
</tr>
<tr>
<td><strong>withPluginInfo</strong></td>
<td>boolean</td>
<td>no</td>
<td>false</td>
<td>if true, include plugin info</td>
</tr>
<tr>
<td><strong>withAttempts</strong></td>
<td>boolean</td>
<td>no</td>
<td>false</td>
<td>if true, include payment attempts</td>
</tr>
<tr>
<td><strong>audit</strong></td>
<td>string</td>
<td>no</td>
<td>&quot;NONE&quot;</td>
<td>Level of audit information to return: &quot;NONE&quot;, &quot;MINIMAL&quot; (only inserts), or &quot;FULL&quot;</td>
</tr>
</tbody></table>

<p><strong>Response</strong></p>

<p>If successful, returns a status code of 200 and a list of all payments matched with the search key entered.</p>

        </div>
        <div class="dark-box">
          <div id="docsearch"></div>
        </div>
      </div>
    </body>
    <script>
      setTimeout(function(){
        $('.content h2, .content h3, .content h4').append('<a href=""><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>');
        $('.content h2, .content h3, .content h4').each(function(){
          let itemHref = '#' + $(this).attr('id');
          $(this).find('a').attr("href", itemHref);
        });
      })

      function restructureDOM() {
        const toElem = (elems) => {
          const elem = document.createElement('div');
          elems.forEach((elm, i) => {
            const childElem = document.createElement('div');
            childElem.classList.add(`section-container`)

            const codeBlocks = document.createElement('div');
            codeBlocks.classList.add('code-block');
            const sectionContent = document.createElement('div');
            sectionContent.classList.add('section-content')

            elm.forEach((el, i) => {
              console.log(el)
              if(el.tagName.toLowerCase() === "blockquote" || el.className === "highlight") {
                codeBlocks.append(el);
              } else {
                sectionContent.append(el);
              }

              childElem.append(sectionContent);
              childElem.append(codeBlocks);
            });

            elem.appendChild(childElem);
            console.log(childElem);
          });
          return elem;
        }

        const content = $('.content').children();

        let oneSection = [];
        let allSections = [];
        let h2Occurence = 0;

        content.each((index, element) => {
          if(h2Occurence !== 0 && (element.tagName === "H2" || element.id === "tenant")) {
            allSections.push(oneSection);
            oneSection = [];
          }
          oneSection.push(element);
          if(element.tagName === "H2") h2Occurence++;
        });

        const convertedNodes = toElem(allSections);
        console.log(convertedNodes, 'convertedNodes')
        $('.content').append(convertedNodes);
      }

      setTimeout(() => {
        restructureDOM()
      }, 1000);
    </script>
    <script src='https://cdn.jsdelivr.net/npm/@docsearch/js@3'></script>
    <script>
      docsearch({apiKey: '3ef227e7fd5e2e1a3fffd880484934bf', container: '#docsearch', appId: 'S2ISXITURI', indexName: 'killbill_slate'});
    </script>
  </html>
