
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Kill Bill</title>

    <style media="screen">
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .ch, .highlight .cd, .highlight .cpf {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s, .highlight .sa, .highlight .dl {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf, .highlight .fm {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv, .highlight .vm {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .nl {
  color: #f92672;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <style media="print">
      * {
        -webkit-transition:none!important;
        transition:none!important;
      }
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight, .highlight .w {
  color: #586e75;
}
.highlight .err {
  color: #002b36;
  background-color: #dc322f;
}
.highlight .c, .highlight .ch, .highlight .cd, .highlight .cm, .highlight .cpf, .highlight .c1, .highlight .cs {
  color: #657b83;
}
.highlight .cp {
  color: #b58900;
}
.highlight .nt {
  color: #b58900;
}
.highlight .o, .highlight .ow {
  color: #93a1a1;
}
.highlight .p, .highlight .pi {
  color: #93a1a1;
}
.highlight .gi {
  color: #859900;
}
.highlight .gd {
  color: #dc322f;
}
.highlight .gh {
  color: #268bd2;
  background-color: #002b36;
  font-weight: bold;
}
.highlight .k, .highlight .kn, .highlight .kp, .highlight .kr, .highlight .kv {
  color: #6c71c4;
}
.highlight .kc {
  color: #cb4b16;
}
.highlight .kt {
  color: #cb4b16;
}
.highlight .kd {
  color: #cb4b16;
}
.highlight .s, .highlight .sb, .highlight .sc, .highlight .dl, .highlight .sd, .highlight .s2, .highlight .sh, .highlight .sx, .highlight .s1 {
  color: #859900;
}
.highlight .sa {
  color: #6c71c4;
}
.highlight .sr {
  color: #2aa198;
}
.highlight .si {
  color: #d33682;
}
.highlight .se {
  color: #d33682;
}
.highlight .nn {
  color: #b58900;
}
.highlight .nc {
  color: #b58900;
}
.highlight .no {
  color: #b58900;
}
.highlight .na {
  color: #268bd2;
}
.highlight .m, .highlight .mb, .highlight .mf, .highlight .mh, .highlight .mi, .highlight .il, .highlight .mo, .highlight .mx {
  color: #859900;
}
.highlight .ss {
  color: #859900;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>

  </head>

  <body class="credit" data-languages="[&quot;shell&quot;,&quot;java&quot;,&quot;ruby&quot;,&quot;python&quot;]">
    <div class="loader-wrapper">
      <div id="loading"></div>           
    </div>
    <script>
      $(window).on('load',function(){
        $('.loader-wrapper').hide();
      });
    </script>
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" alt="" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo.png" class="logo" alt="" />
        <div class="lang-selector">
              <a href="#" data-language-name="shell">shell</a>
              <a href="#" data-language-name="java">java</a>
              <a href="#" data-language-name="ruby">ruby</a>
              <a href="#" data-language-name="python">python</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <ul id="toc" class="toc-list-h1">
          <li>
            <a href="#credit" class="toc-h1 toc-link" data-title="Credit">Credit</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#credit-resource" class="toc-h2 toc-link" data-title="Credit Resource">Credit Resource</a>
                  </li>
                  <li>
                    <a href="#credit-2" class="toc-h2 toc-link" data-title="Credit">Credit</a>
                  </li>
              </ul>
          </li>
      </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='credit'>Credit</h1><h2 id='credit-resource'>Credit Resource</h2>
<p>The <code>Credit</code> resource represents the credits created on behalf of the customer <code>Account</code>. Credits are tracked inside invoices, as a specical kind of
invoice item. The credits are visible at the level of the <code>Account</code>, i.e account credit, and those will automatically be consumed by the system on
subsequent invoices to bring the balance to zero -- or reduce the balance if there is not enough credit to pay the full amount.</p>

<p>See section <a href="invoice.html">Invoice Resource</a> for the description of the <code>InvoiceItem</code> attributes.</p>
<h2 id='credit-2'>Credit</h2>
<p>Basic endpoints to create and retrieve credit invoice items</p>
<h3 id='create-credits'>Create credits</h3>
<p>Create one or more credits for a specified account. These credits will appear as <code>invoiceItem</code>s. They may be added to an existing DRAFT invoice, or they may result in the creation of a new invoice. While adding a credit to an existing invoice, specifying fields like <code>linkedInvoiceItemId</code>, <code>subscriptionId</code> has no effect. These fields do not get saved in the database and will not be returned in subsequent <code>GET</code> requests</p>

<p><strong>HTTP Request</strong> </p>

<p><code>POST http://127.0.0.1:8080/1.0/kb/credits</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="nt">-v</span> <span class="se">\</span>
    <span class="nt">-X</span> POST <span class="se">\</span>
    <span class="nt">-u</span> admin:password <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiKey: bob"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiSecret: lazar"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"Accept: application/json"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-CreatedBy: demo"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-Reason: demo"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-Comment: demo"</span> <span class="se">\</span>
    <span class="nt">-d</span> <span class="s1">'[{"amount": 50.0, "currency": "USD", "accountId": "1f979085-1765-471b-878a-5f640db4d831", "description": "example"}]'</span> <span class="se">\</span>
    <span class="s2">"http://localhost:8080/1.0/kb/credits?autoCommit=true"</span>
</code></pre></div><div class="highlight"><pre class="highlight java tab-java"><code><span class="kn">import</span> <span class="nn">org.killbill.billing.client.api.gen.CreditApi</span><span class="o">;</span>
<span class="kd">protected</span> <span class="nc">CreditApi</span> <span class="n">creditApi</span><span class="o">;</span>

<span class="no">UUID</span> <span class="n">accountId</span> <span class="o">=</span> <span class="no">UUID</span><span class="o">.</span><span class="na">fromString</span><span class="o">(</span><span class="s">"864c1418-e768-4cd5-a0db-67537144b685"</span><span class="o">);</span>

<span class="nc">Credit</span> <span class="n">credit</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">InvoiceItem</span><span class="o">();</span>
<span class="n">credit</span><span class="o">.</span><span class="na">setAccountId</span><span class="o">(</span><span class="n">accountId</span><span class="o">);</span>
<span class="n">credit</span><span class="o">.</span><span class="na">setAmount</span><span class="o">(</span><span class="nc">BigDecimal</span><span class="o">.</span><span class="na">ONE</span><span class="o">);</span>
<span class="n">credit</span><span class="o">.</span><span class="na">setDescription</span><span class="o">(</span><span class="s">"description"</span><span class="o">);</span>

<span class="nc">Boolean</span> <span class="n">autoCommit</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
<span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="n">pluginProperty</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

<span class="kd">final</span> <span class="nc">InvoiceItems</span> <span class="n">credits</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">InvoiceItems</span><span class="o">();</span>
<span class="n">credits</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">credit</span><span class="o">);</span>
<span class="nc">InvoiceItems</span> <span class="n">createdCredits</span> <span class="o">=</span> <span class="n">creditApi</span><span class="o">.</span><span class="na">createCredits</span><span class="o">(</span><span class="n">credits</span><span class="o">,</span> <span class="kc">false</span><span class="o">,</span> <span class="no">NULL_PLUGIN_PROPERTIES</span><span class="o">,</span> <span class="n">requestOptions</span><span class="o">);</span>
</code></pre></div><div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="n">credit_item</span>                 <span class="o">=</span> <span class="no">KillBillClient</span><span class="o">::</span><span class="no">Model</span><span class="o">::</span><span class="no">Credit</span><span class="p">.</span><span class="nf">new</span><span class="p">()</span>
<span class="n">credit_item</span><span class="p">.</span><span class="nf">account_id</span>      <span class="o">=</span> <span class="s1">'da3769a8-58c4-4dc0-b4e8-7b534e349624'</span>
<span class="n">credit_item</span><span class="p">.</span><span class="nf">amount</span>          <span class="o">=</span> <span class="mf">50.0</span>
<span class="n">credit_item</span><span class="p">.</span><span class="nf">currency</span>        <span class="o">=</span> <span class="s1">'USD'</span>
<span class="n">credit_item</span><span class="p">.</span><span class="nf">description</span>     <span class="o">=</span> <span class="s1">'description'</span>

<span class="n">auto_commit</span> <span class="o">=</span> <span class="kp">true</span>

<span class="n">credit_item</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="n">auto_commit</span><span class="p">,</span> 
                   <span class="n">user</span><span class="p">,</span>
                   <span class="n">reason</span><span class="p">,</span>
                   <span class="n">comment</span><span class="p">,</span>
                   <span class="n">options</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="n">creditApi</span> <span class="o">=</span> <span class="n">killbill</span><span class="p">.</span><span class="n">api</span><span class="p">.</span><span class="n">CreditApi</span><span class="p">()</span>
<span class="n">body</span> <span class="o">=</span> <span class="n">Credit</span><span class="p">(</span><span class="n">account_id</span><span class="o">=</span><span class="n">account_id</span><span class="p">,</span> 
              <span class="n">amount</span><span class="o">=</span><span class="mf">50.0</span><span class="p">,</span> 
              <span class="n">currency</span><span class="o">=</span><span class="s">'USD'</span><span class="p">,</span> 
              <span class="n">description</span><span class="o">=</span><span class="s">'example'</span><span class="p">)</span>

<span class="n">creditApi</span><span class="p">.</span><span class="n">create_credits</span><span class="p">([</span><span class="n">body</span><span class="p">],</span> <span class="n">created_by</span><span class="p">,</span> <span class="n">api_key</span><span class="p">,</span> <span class="n">api_secret</span><span class="p">)</span>
</code></pre></div>
<blockquote>
<p>Example Response:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"invoiceItemId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2a7746a3-abad-42d9-9f54-fe50c0b18802"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"invoiceId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"e3caf986-8909-4677-afd4-ba03deeae8f0"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"linkedInvoiceItemId"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"accountId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1f979085-1765-471b-878a-5f640db4d831"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"childAccountId"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"bundleId"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"subscriptionId"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"productName"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"planName"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"phaseName"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"usageName"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"prettyProductName"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"prettyPlanName"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"prettyPhaseName"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"prettyUsageName"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"itemType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CREDIT_ADJ"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"example"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"startDate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-01-17"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"endDate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-01-17"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">50</span><span class="p">,</span><span class="w">
    </span><span class="nl">"rate"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"currency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"USD"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"quantity"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"itemDetails"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"catalogEffectiveDate"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"childItems"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"auditLogs"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div>
<p><strong>Request Body</strong></p>

<p>A list of one or more invoiceItem objects. Each object requires at least the following attributes: accountId and amount. If an invoiceId is given, the item will be added to the specified invoice. This invoice must be in DRAFT status or an error will occur. </p>

<p><strong>Query Parameters</strong></p>

<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Required</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>autoCommit</strong></td>
<td>boolean</td>
<td>no</td>
<td>false</td>
<td>if true, the resulting invoice will be <code>COMMITTED</code>.</td>
</tr>
</tbody></table>

<p><strong>Returns</strong></p>

<p>If successful, returns a status code of 200 and a list of invoiceItem resource objects representing the credit(s).</p>
<h3 id='retrieve-a-credit-by-id'>Retrieve a credit by id</h3>
<p>Retrieve an invoiceItem representing a credit given the invoiceItemId.</p>

<p><strong>HTTP Request</strong> </p>

<p><code>GET http://127.0.0.1:8080/1.0/kb/credits/{invoiceItemId}</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="nt">-v</span> <span class="se">\</span>
    <span class="nt">-u</span> admin:password <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiKey: bob"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiSecret: lazar"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"Accept: application/json"</span> <span class="se">\</span>
    <span class="s2">"http://localhost:8080/1.0/kb/credits/c8bfa9d1-76e5-4a42-92d0-b106c0902c16"</span> 
</code></pre></div><div class="highlight"><pre class="highlight java tab-java"><code><span class="kn">import</span> <span class="nn">org.killbill.billing.client.api.gen.CreditApi</span><span class="o">;</span>
<span class="kd">protected</span> <span class="nc">CreditApi</span> <span class="n">creditApi</span><span class="o">;</span>

<span class="no">UUID</span> <span class="n">creditId</span> <span class="o">=</span> <span class="no">UUID</span><span class="o">.</span><span class="na">fromString</span><span class="o">(</span><span class="s">"d2edf4c0-9929-4e2f-b3a9-feb9bd9d60ba"</span><span class="o">);</span>

<span class="nc">Credit</span> <span class="n">result</span> <span class="o">=</span> <span class="n">creditApi</span><span class="o">.</span><span class="na">getCredit</span><span class="o">(</span><span class="n">creditId</span><span class="o">,</span> <span class="n">requestOptions</span><span class="o">)</span>
</code></pre></div><div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="n">credit_id</span> <span class="o">=</span> <span class="s1">'fd5669a8-68c1-8dl0-m4e8-8y535e349324'</span>

<span class="no">KillBillClient</span><span class="o">::</span><span class="no">Model</span><span class="o">::</span><span class="no">Credit</span><span class="p">.</span><span class="nf">find_by_id</span><span class="p">(</span><span class="n">credit_id</span> <span class="p">,</span> <span class="n">options</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="n">creditApi</span> <span class="o">=</span> <span class="n">killbill</span><span class="p">.</span><span class="n">api</span><span class="p">.</span><span class="n">CreditApi</span><span class="p">()</span>

<span class="n">creditApi</span><span class="p">.</span><span class="n">get_credit</span><span class="p">(</span><span class="n">credit_id</span><span class="p">,</span> <span class="n">api_key</span><span class="p">,</span> <span class="n">api_secret</span><span class="p">)</span>
</code></pre></div>
<blockquote>
<p>Example Response:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"invoiceItemId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"c8bfa9d1-76e5-4a42-92d0-b106c0902c16"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">50</span><span class="p">,</span><span class="w">
  </span><span class="nl">"currency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"USD"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"invoiceId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"903e55d3-8072-47f1-80fc-32857dbdbcc5"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"invoiceNumber"</span><span class="p">:</span><span class="w"> </span><span class="s2">"310"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"effectiveDate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-07-20"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"accountId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2ad52f53-85ae-408a-9879-32a7e59dd03d"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"example"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"itemDetails"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nl">"auditLogs"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p><strong>Query Parameters</strong></p>

<p>None.</p>

<p><strong>Returns</strong></p>

<p>If successful, returns a status code of 200 and an invoiceItem resource object with itemType CREDIT_ADJ representing a credit.</p>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="shell">shell</a>
                <a href="#" data-language-name="java">java</a>
                <a href="#" data-language-name="ruby">ruby</a>
                <a href="#" data-language-name="python">python</a>
          </div>

        <div id="docsearch"></div>
        
        <div id="toc" class="toc-list-h1">
            <li>
              <a href="#credit" class="toc-h1 toc-link" data-title="Credit">Credit</a>
                <ul class="toc-list-h2">
                    <li>
                      <a href="#credit-resource" class="toc-h2 toc-link" data-title="Credit Resource">Credit Resource</a>
                    </li>
                    <li>
                      <a href="#credit-2" class="toc-h2 toc-link" data-title="Credit">Credit</a>
                          <ul class="toc-list-h3">
                                <li>
                                  <a href="#create-credits" class="toc-h3 toc-link" data-title="Credit">Create credits</a>
                                </li>
                                <li>
                                  <a href="#retrieve-a-credit-by-id" class="toc-h3 toc-link" data-title="Credit">Retrieve a credit by id</a>
                                </li>
                          </ul>
                    </li>
                </ul>
            </li>
        </div>
      </div>
      <div class="page-wrapper">
        <div class="dark-box"></div>
        <div class="content">
          <h1 id='credit'>Credit</h1><h2 id='credit-resource'>Credit Resource</h2>
<p>The <code>Credit</code> resource represents the credits created on behalf of the customer <code>Account</code>. Credits are tracked inside invoices, as a specical kind of
invoice item. The credits are visible at the level of the <code>Account</code>, i.e account credit, and those will automatically be consumed by the system on
subsequent invoices to bring the balance to zero -- or reduce the balance if there is not enough credit to pay the full amount.</p>

<p>See section <a href="invoice.html">Invoice Resource</a> for the description of the <code>InvoiceItem</code> attributes.</p>
<h2 id='credit-2'>Credit</h2>
<p>Basic endpoints to create and retrieve credit invoice items</p>
<h3 id='create-credits'>Create credits</h3>
<p>Create one or more credits for a specified account. These credits will appear as <code>invoiceItem</code>s. They may be added to an existing DRAFT invoice, or they may result in the creation of a new invoice. While adding a credit to an existing invoice, specifying fields like <code>linkedInvoiceItemId</code>, <code>subscriptionId</code> has no effect. These fields do not get saved in the database and will not be returned in subsequent <code>GET</code> requests</p>

<p><strong>HTTP Request</strong> </p>

<p><code>POST http://127.0.0.1:8080/1.0/kb/credits</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="nt">-v</span> <span class="se">\</span>
    <span class="nt">-X</span> POST <span class="se">\</span>
    <span class="nt">-u</span> admin:password <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiKey: bob"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiSecret: lazar"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"Accept: application/json"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-CreatedBy: demo"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-Reason: demo"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-Comment: demo"</span> <span class="se">\</span>
    <span class="nt">-d</span> <span class="s1">'[{"amount": 50.0, "currency": "USD", "accountId": "1f979085-1765-471b-878a-5f640db4d831", "description": "example"}]'</span> <span class="se">\</span>
    <span class="s2">"http://localhost:8080/1.0/kb/credits?autoCommit=true"</span>
</code></pre></div><div class="highlight"><pre class="highlight java tab-java"><code><span class="kn">import</span> <span class="nn">org.killbill.billing.client.api.gen.CreditApi</span><span class="o">;</span>
<span class="kd">protected</span> <span class="nc">CreditApi</span> <span class="n">creditApi</span><span class="o">;</span>

<span class="no">UUID</span> <span class="n">accountId</span> <span class="o">=</span> <span class="no">UUID</span><span class="o">.</span><span class="na">fromString</span><span class="o">(</span><span class="s">"864c1418-e768-4cd5-a0db-67537144b685"</span><span class="o">);</span>

<span class="nc">Credit</span> <span class="n">credit</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">InvoiceItem</span><span class="o">();</span>
<span class="n">credit</span><span class="o">.</span><span class="na">setAccountId</span><span class="o">(</span><span class="n">accountId</span><span class="o">);</span>
<span class="n">credit</span><span class="o">.</span><span class="na">setAmount</span><span class="o">(</span><span class="nc">BigDecimal</span><span class="o">.</span><span class="na">ONE</span><span class="o">);</span>
<span class="n">credit</span><span class="o">.</span><span class="na">setDescription</span><span class="o">(</span><span class="s">"description"</span><span class="o">);</span>

<span class="nc">Boolean</span> <span class="n">autoCommit</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
<span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="n">pluginProperty</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

<span class="kd">final</span> <span class="nc">InvoiceItems</span> <span class="n">credits</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">InvoiceItems</span><span class="o">();</span>
<span class="n">credits</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">credit</span><span class="o">);</span>
<span class="nc">InvoiceItems</span> <span class="n">createdCredits</span> <span class="o">=</span> <span class="n">creditApi</span><span class="o">.</span><span class="na">createCredits</span><span class="o">(</span><span class="n">credits</span><span class="o">,</span> <span class="kc">false</span><span class="o">,</span> <span class="no">NULL_PLUGIN_PROPERTIES</span><span class="o">,</span> <span class="n">requestOptions</span><span class="o">);</span>
</code></pre></div><div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="n">credit_item</span>                 <span class="o">=</span> <span class="no">KillBillClient</span><span class="o">::</span><span class="no">Model</span><span class="o">::</span><span class="no">Credit</span><span class="p">.</span><span class="nf">new</span><span class="p">()</span>
<span class="n">credit_item</span><span class="p">.</span><span class="nf">account_id</span>      <span class="o">=</span> <span class="s1">'da3769a8-58c4-4dc0-b4e8-7b534e349624'</span>
<span class="n">credit_item</span><span class="p">.</span><span class="nf">amount</span>          <span class="o">=</span> <span class="mf">50.0</span>
<span class="n">credit_item</span><span class="p">.</span><span class="nf">currency</span>        <span class="o">=</span> <span class="s1">'USD'</span>
<span class="n">credit_item</span><span class="p">.</span><span class="nf">description</span>     <span class="o">=</span> <span class="s1">'description'</span>

<span class="n">auto_commit</span> <span class="o">=</span> <span class="kp">true</span>

<span class="n">credit_item</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="n">auto_commit</span><span class="p">,</span> 
                   <span class="n">user</span><span class="p">,</span>
                   <span class="n">reason</span><span class="p">,</span>
                   <span class="n">comment</span><span class="p">,</span>
                   <span class="n">options</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="n">creditApi</span> <span class="o">=</span> <span class="n">killbill</span><span class="p">.</span><span class="n">api</span><span class="p">.</span><span class="n">CreditApi</span><span class="p">()</span>
<span class="n">body</span> <span class="o">=</span> <span class="n">Credit</span><span class="p">(</span><span class="n">account_id</span><span class="o">=</span><span class="n">account_id</span><span class="p">,</span> 
              <span class="n">amount</span><span class="o">=</span><span class="mf">50.0</span><span class="p">,</span> 
              <span class="n">currency</span><span class="o">=</span><span class="s">'USD'</span><span class="p">,</span> 
              <span class="n">description</span><span class="o">=</span><span class="s">'example'</span><span class="p">)</span>

<span class="n">creditApi</span><span class="p">.</span><span class="n">create_credits</span><span class="p">([</span><span class="n">body</span><span class="p">],</span> <span class="n">created_by</span><span class="p">,</span> <span class="n">api_key</span><span class="p">,</span> <span class="n">api_secret</span><span class="p">)</span>
</code></pre></div>
<blockquote>
<p>Example Response:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"invoiceItemId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2a7746a3-abad-42d9-9f54-fe50c0b18802"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"invoiceId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"e3caf986-8909-4677-afd4-ba03deeae8f0"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"linkedInvoiceItemId"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"accountId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1f979085-1765-471b-878a-5f640db4d831"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"childAccountId"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"bundleId"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"subscriptionId"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"productName"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"planName"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"phaseName"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"usageName"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"prettyProductName"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"prettyPlanName"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"prettyPhaseName"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"prettyUsageName"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"itemType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CREDIT_ADJ"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"example"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"startDate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-01-17"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"endDate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-01-17"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">50</span><span class="p">,</span><span class="w">
    </span><span class="nl">"rate"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"currency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"USD"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"quantity"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"itemDetails"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"catalogEffectiveDate"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"childItems"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"auditLogs"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div>
<p><strong>Request Body</strong></p>

<p>A list of one or more invoiceItem objects. Each object requires at least the following attributes: accountId and amount. If an invoiceId is given, the item will be added to the specified invoice. This invoice must be in DRAFT status or an error will occur. </p>

<p><strong>Query Parameters</strong></p>

<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Required</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>autoCommit</strong></td>
<td>boolean</td>
<td>no</td>
<td>false</td>
<td>if true, the resulting invoice will be <code>COMMITTED</code>.</td>
</tr>
</tbody></table>

<p><strong>Returns</strong></p>

<p>If successful, returns a status code of 200 and a list of invoiceItem resource objects representing the credit(s).</p>
<h3 id='retrieve-a-credit-by-id'>Retrieve a credit by id</h3>
<p>Retrieve an invoiceItem representing a credit given the invoiceItemId.</p>

<p><strong>HTTP Request</strong> </p>

<p><code>GET http://127.0.0.1:8080/1.0/kb/credits/{invoiceItemId}</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="nt">-v</span> <span class="se">\</span>
    <span class="nt">-u</span> admin:password <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiKey: bob"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiSecret: lazar"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"Accept: application/json"</span> <span class="se">\</span>
    <span class="s2">"http://localhost:8080/1.0/kb/credits/c8bfa9d1-76e5-4a42-92d0-b106c0902c16"</span> 
</code></pre></div><div class="highlight"><pre class="highlight java tab-java"><code><span class="kn">import</span> <span class="nn">org.killbill.billing.client.api.gen.CreditApi</span><span class="o">;</span>
<span class="kd">protected</span> <span class="nc">CreditApi</span> <span class="n">creditApi</span><span class="o">;</span>

<span class="no">UUID</span> <span class="n">creditId</span> <span class="o">=</span> <span class="no">UUID</span><span class="o">.</span><span class="na">fromString</span><span class="o">(</span><span class="s">"d2edf4c0-9929-4e2f-b3a9-feb9bd9d60ba"</span><span class="o">);</span>

<span class="nc">Credit</span> <span class="n">result</span> <span class="o">=</span> <span class="n">creditApi</span><span class="o">.</span><span class="na">getCredit</span><span class="o">(</span><span class="n">creditId</span><span class="o">,</span> <span class="n">requestOptions</span><span class="o">)</span>
</code></pre></div><div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="n">credit_id</span> <span class="o">=</span> <span class="s1">'fd5669a8-68c1-8dl0-m4e8-8y535e349324'</span>

<span class="no">KillBillClient</span><span class="o">::</span><span class="no">Model</span><span class="o">::</span><span class="no">Credit</span><span class="p">.</span><span class="nf">find_by_id</span><span class="p">(</span><span class="n">credit_id</span> <span class="p">,</span> <span class="n">options</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="n">creditApi</span> <span class="o">=</span> <span class="n">killbill</span><span class="p">.</span><span class="n">api</span><span class="p">.</span><span class="n">CreditApi</span><span class="p">()</span>

<span class="n">creditApi</span><span class="p">.</span><span class="n">get_credit</span><span class="p">(</span><span class="n">credit_id</span><span class="p">,</span> <span class="n">api_key</span><span class="p">,</span> <span class="n">api_secret</span><span class="p">)</span>
</code></pre></div>
<blockquote>
<p>Example Response:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"invoiceItemId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"c8bfa9d1-76e5-4a42-92d0-b106c0902c16"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">50</span><span class="p">,</span><span class="w">
  </span><span class="nl">"currency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"USD"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"invoiceId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"903e55d3-8072-47f1-80fc-32857dbdbcc5"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"invoiceNumber"</span><span class="p">:</span><span class="w"> </span><span class="s2">"310"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"effectiveDate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-07-20"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"accountId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2ad52f53-85ae-408a-9879-32a7e59dd03d"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"example"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"itemDetails"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nl">"auditLogs"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p><strong>Query Parameters</strong></p>

<p>None.</p>

<p><strong>Returns</strong></p>

<p>If successful, returns a status code of 200 and an invoiceItem resource object with itemType CREDIT_ADJ representing a credit.</p>

        </div>
        <div class="dark-box">
            <div class="lang-selector">
                  <a href="#" data-language-name="shell">shell</a>
                  <a href="#" data-language-name="java">java</a>
                  <a href="#" data-language-name="ruby">ruby</a>
                  <a href="#" data-language-name="python">python</a>
            </div>
        </div>
      </div>
    </div>
  </body>
  <script>
    setTimeout(function(){
      $('.content h2, .content h3, .content h4').append('<a href=""><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>');
      $('.content h2, .content h3, .content h4').each(function(){
        let itemHref = '#' + $(this).attr('id');
        $(this).find('a').attr("href", itemHref);
      });
    });
  </script>
  <script src='https://cdn.jsdelivr.net/npm/@docsearch/js@3'></script>	
  
  <script >docsearch({apiKey: '3ef227e7fd5e2e1a3fffd880484934bf', container: '#docsearch', appId: 'S2ISXITURI', indexName: 'killbill_slate'});</script>
</html>

